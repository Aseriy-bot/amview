<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMVIEW - Premium Movie Streaming</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="AMVIEW - Premium movie streaming service with unlimited movies, TV shows, and more. Watch anywhere, cancel anytime.">
    <meta name="keywords" content="movies, streaming, TV shows, entertainment, AMVIEW">
    <meta name="author" content="AMVIEW">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="AMVIEW - Premium Movie Streaming">
    <meta property="og:description" content="Unlimited movies, TV shows, and more. Watch anywhere. Cancel anytime.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="./img/og-image.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="./img/fav.png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
<style>
    :root {
        --primary: linear-gradient(135deg, #3b93c3, #16dcd4);
        --primary-dark: linear-gradient(135deg, #2d78a0, #0fb4af);
        --secondary: #1a1a1a;
        --dark: #000000;
        --light: #ffffff;
        --gray: #2a2a2a;
        --gray-light: #404040;
        --text: #e5e5e5;
        --text-secondary: #a3a3a3;
        --accent: #ff6b6b;
        --success: #4ecdc4;
        --warning: #ffe66d;
        --glass: rgba(255, 255, 255, 0.1);
        --glass-border: rgba(255, 255, 255, 0.2);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    html {
        scroll-behavior: smooth;
    }

    body {
        background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #0f0f0f 100%);
        color: var(--text);
        line-height: 1.6;
        overflow-x: hidden;
        font-weight: 400;
    }

    /* Skip Link for Accessibility */
    .skip-link {
        position: absolute;
        top: -40px;
        left: 6px;
        background: var(--primary);
        color: white;
        padding: 8px;
        text-decoration: none;
        border-radius: 4px;
        z-index: 10000;
        transition: top 0.3s;
    }

    .skip-link:focus {
        top: 6px;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: var(--dark);
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #3b93c3, #16dcd4);
        border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(135deg, #2d78a0, #0fb4af);
    }

    /* Firefox */
    html {
        scrollbar-width: thin;
        scrollbar-color: #3b93c3 var(--dark);
    }

    .container {
        width: 100%;
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 20px;
    }

    .hidden {
        display: none !important;
    }

    /* Glassmorphism Effects */
    .glass {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
    }

    /* Enhanced Animations */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeInLeft {
        from {
            opacity: 0;
            transform: translateX(-30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    @keyframes fadeInRight {
        from {
            opacity: 0;
            transform: translateX(30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    @keyframes scaleIn {
        from {
            opacity: 0;
            transform: scale(0.9);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    @keyframes pulse {
        0%, 100% {
            transform: scale(1);
        }
        50% {
            transform: scale(1.05);
        }
    }

    @keyframes glow {
        0%, 100% {
            box-shadow: 0 0 20px rgba(59, 147, 195, 0.3);
        }
        50% {
            box-shadow: 0 0 40px rgba(59, 147, 195, 0.6);
        }
    }

    @keyframes float {
        0%, 100% {
            transform: translateY(0px);
        }
        50% {
            transform: translateY(-10px);
        }
    }

    @keyframes slideInFromTop {
        from {
            opacity: 0;
            transform: translateY(-100%);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes shimmer {
        0% {
            background-position: -200% 0;
        }
        100% {
            background-position: 200% 0;
        }
    }

    /* Animated Elements */
    .animate-on-scroll {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .animate-on-scroll.visible {
        opacity: 1;
        transform: translateY(0);
    }

    /* Background for user pages */
    .user-page-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #0f0f0f 100%);
        z-index: -1;
        pointer-events: none;
    }

    #home-page .user-page-bg {
        height: 100vh;
    }

    #home-page .user-page-bg .bg-video {
        position: absolute;
        top: 50%;
        left: 50%;
        min-width: 100%;
        min-height: 100%;
        width: auto;
        height: auto;
        object-fit: cover;  
        transform: translate(-50%, -50%);
        z-index: 1;
        opacity: 0.4;
    }

    #home-page .user-page-bg::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(26, 26, 26, 0.6) 50%, rgba(0, 0, 0, 0.8) 100%);
        z-index: 2;
    }

    #browse-page .user-page-bg,
    #my-list-page .user-page-bg,
    #profile-page .user-page-bg {
        background: linear-gradient(135deg, rgba(15, 15, 15, 0.95) 0%, rgba(26, 26, 26, 0.9) 50%, rgba(15, 15, 15, 0.95) 100%),
                    url('https://images.unsplash.com/photo-1535016120720-40c646be5580?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
    }

    #browse-page .section-title{
        padding: 2rem;
    }

    #movie-details-page .user-page-bg {
        background-image: var(--movie-background);
        opacity: 0.3;
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
    }

    /* Enhanced Loading Spinner */
    .spinner {
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top: 4px solid transparent;
        border-right: 4px solid transparent;
        background: conic-gradient(from 0deg, #3b93c3, #16dcd4, #3b93c3);
        width: 50px;
        height: 50px;
        animation: spin 1.5s linear infinite;
        margin: 20px auto;
        position: relative;
    }

    .spinner::before {
        content: '';
        position: absolute;
        top: 2px;
        left: 2px;
        right: 2px;
        bottom: 2px;
        background: var(--dark);
        border-radius: 50%;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Enhanced Notification System */
    .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 16px 24px;
        border-radius: 12px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        color: white;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        z-index: 10000;
        transform: translateX(150%) scale(0.8);
        transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        font-weight: 500;
    }

    .notification.show {
        transform: translateX(0) scale(1);
    }

    .notification.success {
        background: linear-gradient(135deg, rgba(76, 175, 80, 0.9), rgba(69, 160, 73, 0.9));
        border-color: rgba(76, 175, 80, 0.3);
    }

    .notification.error {
        background: linear-gradient(135deg, rgba(244, 67, 54, 0.9), rgba(211, 47, 47, 0.9));
        border-color: rgba(244, 67, 54, 0.3);
    }

    /* Enhanced Login Page */
    .login-page {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(26, 26, 26, 0.6) 50%, rgba(0, 0, 0, 0.8) 100%),
                    url('https://images.unsplash.com/photo-1489599809505-f2e90e8e08c2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        position: relative;
        overflow: hidden;
    }

    .login-page::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(circle at 20% 80%, rgba(59, 147, 195, 0.1) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(22, 220, 212, 0.1) 0%, transparent 50%);
        pointer-events: none;
    }

    .login-header {
        padding: 20px 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        animation: slideInFromTop 1s ease-out;
    }

    .login-logo {
        text-align: left;
        padding-left: 50px;
    }

    .login-logo h1 {
        font-size: 2.8rem;
        background: var(--primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
        letter-spacing: 2px;
        text-shadow: 0 0 30px rgba(59, 147, 195, 0.3);
    }

    .auth-buttons {
        padding-right: 50px;
        animation: fadeInRight 1s ease-out 0.3s both;
    }

    .btn-login-hero {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        color: var(--light);
        padding: 12px 28px;
        font-size: 1rem;
        border-radius: 50px;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-weight: 600;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
        overflow: hidden;
        cursor: pointer;
    }

    .btn-login-hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: var(--primary);
        transition: left 0.4s ease;
        z-index: -1;
    }

    .btn-login-hero:hover::before {
        left: 0;
    }

    .btn-login-hero:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 10px 30px rgba(59, 147, 195, 0.4);
    }

    .login-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 0 20px;
        animation: fadeInUp 1s ease-out 0.6s both;
    }

    .login-hero {
        max-width: 900px;
        margin-bottom: 40px;
    }

    .login-hero h2 {
        font-size: 4rem;
        margin-bottom: 20px;
        line-height: 1.2;
        font-weight: 800;
        background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 4px 20px rgba(255, 255, 255, 0.1);
    }

    .login-hero p {
        font-size: 1.6rem;
        margin-bottom: 30px;
        color: var(--text-secondary);
        font-weight: 400;
    }

    .hero-subtitle {
        font-size: 1.4rem;
        margin: 20px 0;
        color: var(--text-secondary);
        font-weight: 300;
    }

    /* Enhanced Email Signup */
    .email-signup {
        display: flex;
        max-width: 650px;
        margin: 20px auto;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 60px;
        padding: 6px;
        transition: all 0.3s ease;
    }

    .email-signup:hover {
        box-shadow: 0 8px 32px rgba(59, 147, 195, 0.2);
    }

    .email-signup input {
        flex: 1;
        padding: 16px 24px;
        font-size: 1.1rem;
        border: none;
        border-radius: 50px;
        background: transparent;
        color: white;
        outline: none;
        font-weight: 400;
    }

    .email-signup input::placeholder {
        color: rgba(255, 255, 255, 0.6);
    }

    .btn-get-started {
        background: var(--primary);
        color: white;
        border: none;
        padding: 16px 32px;
        font-size: 1.2rem;
        font-weight: 700;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        white-space: nowrap;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .btn-get-started:hover {
        background: var(--primary-dark);
        transform: scale(1.05);
        box-shadow: 0 8px 25px rgba(59, 147, 195, 0.4);
    }

    /* Enhanced Features Section */
    .login-page .features-section {
        display: block !important;
        opacity: 1 !important;
        visibility: visible !important;
    }

    /* Ensure features are properly styled on login page */
    .login-page .feature {
        display: flex !important;
        opacity: 1 !important;
        visibility: visible !important;
    }

    .features-section {
        padding: 80px 0;
        background: rgba(0, 0, 0, 0.9);
        border-top: 1px solid var(--glass-border);
        position: relative;
    }

    .feature {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 80px;
        gap: 60px;
        opacity: 0;
        transform: translateY(50px);
        transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .feature.visible {
        opacity: 1;
        transform: translateY(0);
    }

    .feature.reverse {
        flex-direction: row-reverse;
    }

    .feature-content {
        flex: 1;
    }

    .feature-content h3 {
        font-size: 3rem;
        margin-bottom: 24px;
        font-weight: 800;
        background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .feature-content p {
        font-size: 1.4rem;
        color: var(--text-secondary);
        line-height: 1.6;
        font-weight: 400;
    }

    .feature-image {
        flex: 1;
        position: relative;
        overflow: hidden;
        border-radius: 20px;
    }

    .feature-image img {
        width: 100%;
        height: 400px;
        object-fit: cover;
        border-radius: 20px;
        transition: transform 0.6s ease;
        filter: brightness(0.8) contrast(1.1);
    }

    .feature-image:hover img {
        transform: scale(1.1);
    }

    .feature-image::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(59, 147, 195, 0.2) 0%, rgba(22, 220, 212, 0.2) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 20px;
        z-index: 1;
    }

    .feature-image:hover::before {
        opacity: 1;
    }

    /* Enhanced FAQ Section */
    .faq-section {
        padding: 80px 0;
        background: rgba(0, 0, 0, 0.95);
        border-top: 1px solid var(--glass-border);
    }

    .faq-section h2 {
        text-align: center;
        font-size: 3rem;
        margin-bottom: 50px;
        font-weight: 800;
        background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .faq-list {
        max-width: 900px;
        margin: 0 auto;
    }

    .faq-item {
        margin-bottom: 16px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .faq-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .faq-question {
        width: 100%;
        padding: 24px;
        background: transparent;
        border: none;
        color: var(--text);
        font-size: 1.3rem;
        text-align: left;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
        font-weight: 600;
    }

    .faq-question:hover {
        color: #16dcd4;
    }

    .faq-question i {
        transition: transform 0.3s ease;
    }

    .faq-question.active i {
        transform: rotate(45deg);
    }

    .faq-answer {
        padding: 0 24px;
        max-height: 0;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        color: var(--text-secondary);
        line-height: 1.6;
    }

    .faq-answer.active {
        padding: 0 24px 24px;
        max-height: 200px;
    }

    /* Enhanced CTA Section */
    .cta-section {
        padding: 80px 0;
        text-align: center;
        background: linear-gradient(135deg, rgba(59, 147, 195, 0.1) 0%, rgba(22, 220, 212, 0.1) 100%);
        border-top: 1px solid var(--glass-border);
    }

    .cta-section p {
        font-size: 1.5rem;
        margin-bottom: 30px;
        font-weight: 500;
    }

    /* Enhanced Login Modal */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .login-modal {
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border: 1px solid var(--glass-border);
        padding: 40px;
        border-radius: 24px;
        width: 100%;
        max-width: 480px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        transform: scale(0.8) translateY(-50px);
        opacity: 0;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        max-height: 90vh;
        overflow-y: auto;
    }

    .modal-overlay.active .login-modal {
        transform: scale(1) translateY(0);
        opacity: 1;
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .modal-header h2 {
        font-size: 2rem;
        font-weight: 700;
        background: var(--primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .close-modal {
        background: none;
        border: none;
        color: var(--text);
        font-size: 1.8rem;
        cursor: pointer;
        transition: all 0.3s ease;
        padding: 8px;
        border-radius: 50%;
    }

    .close-modal:hover {
        color: #16dcd4;
        background: rgba(255, 255, 255, 0.1);
        transform: rotate(90deg);
    }

    /* Enhanced Auth Tabs */
    .auth-tabs {
        display: flex;
        border-bottom: 1px solid var(--glass-border);
        margin-bottom: 24px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        border-radius: 12px 12px 0 0;
    }

    .auth-tab {
        flex: 1;
        padding: 16px;
        background: transparent;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        position: relative;
    }

    .auth-tab.active {
        color: #16dcd4;
        background: rgba(22, 220, 212, 0.1);
    }

    .auth-tab::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 3px;
        background: var(--primary);
        transition: width 0.3s ease;
    }

    .auth-tab.active::after {
        width: 100%;
    }

    .auth-tab:hover:not(.active) {
        color: var(--text);
        background: rgba(255, 255, 255, 0.05);
    }

    /* Auth Forms */
    .auth-form {
        display: none;
        animation: fadeInUp 0.5s ease;
    }

    .auth-form.active {
        display: block;
    }

    /* Enhanced Form Elements */
    .form-group {
        margin-bottom: 24px;
        text-align: left;
    }

    label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--text);
    }

    input, select, textarea {
        width: 100%;
        padding: 16px 20px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        color: var(--text);
        font-size: 1rem;
        transition: all 0.3s ease;
        font-weight: 400;
    }

    input:focus, select:focus, textarea:focus {
        outline: none;
        border-color: #3b93c3;
        box-shadow: 0 0 20px rgba(59, 147, 195, 0.2);
        transform: translateY(-2px);
    }

    input::placeholder, textarea::placeholder {
        color: rgba(255, 255, 255, 0.5);
    }

    /* Enhanced Buttons */
    .btn {
        padding: 16px 32px;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        border: none;
        font-size: 1rem;
        position: relative;
        overflow: hidden;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.6s;
    }

    .btn:hover::before {
        left: 100%;
    }

    .btn-login {
        background: var(--primary);
        color: var(--light);
        width: 100%;
    }

    .btn-login:hover {
        background: var(--primary-dark);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(59, 147, 195, 0.4);
    }

    /* User Type Selection */
    .user-type-selection {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }

    .user-type-option {
        flex: 1;
        padding: 15px;
        background: var(--glass);
        border: 1px solid var(--glass-border);
        border-radius: 10px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .user-type-option.selected {
        background: rgba(59, 147, 195, 0.2);
        border-color: #3b93c3;
    }

    .user-type-option i {
        font-size: 24px;
        margin-bottom: 10px;
        display: block;
    }

    /* Payment Method Selection */
    .payment-method-selection {
        display: none;
        margin-bottom: 20px;
    }

    .payment-option {
        padding: 15px;
        background: var(--glass);
        border: 1px solid var(--glass-border);
        border-radius: 10px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .payment-option.selected {
        background: rgba(59, 147, 195, 0.2);
        border-color: #3b93c3;
    }

    /* Mobile Money Options */
    .mobile-money-options {
        display: none;
        margin-top: 15px;
    }

    .mobile-money-option {
        padding: 12px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .mobile-money-option.selected {
        background: rgba(59, 147, 195, 0.2);
    }

    /* Bank Options */
    .bank-options {
        display: none;
        margin-top: 15px;
    }

    .bank-option {
        padding: 12px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .bank-option.selected {
        background: rgba(59, 147, 195, 0.2);
    }

    /* Enhanced Demo Accounts */
    .demo-accounts {
        margin-top: 24px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        font-size: 0.9rem;
        text-align: left;
    }

    .demo-accounts h3 {
        margin-bottom: 12px;
        color: var(--text);
        font-weight: 600;
    }

    .demo-account {
        margin-bottom: 8px;
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        font-family: 'Courier New', monospace;
    }

    /* Terms Link */
    .terms-link {
        color: #16dcd4;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .terms-link:hover {
        text-decoration: underline;
    }

    /* Password Strength Indicator */
    .password-strength {
        margin-top: 8px;
        font-size: 0.8rem;
    }

    .strength-bar {
        height: 4px;
        background: var(--glass-border);
        border-radius: 2px;
        margin-top: 4px;
        overflow: hidden;
    }

    .strength-fill {
        height: 100%;
        width: 0%;
        transition: all 0.3s ease;
        border-radius: 2px;
    }

    .strength-weak { background: #ff6b6b; width: 33%; }
    .strength-medium { background: #ffe66d; width: 66%; }
    .strength-strong { background: #4ecdc4; width: 100%; }

    /* Form Validation Styles */
    .form-group .error {
        color: #ff6b6b;
        font-size: 0.8rem;
        margin-top: 4px;
        display: none;
    }

    .form-group.error input {
        border-color: #ff6b6b;
    }

    .form-group.success input {
        border-color: #4ecdc4;
    }

    /* Enhanced Trending Section */
    .trending-section {
        padding: 80px 0;
        background: rgba(0, 0, 0, 0.8);
        width: 100%;
    }

    .trending-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .trending-header h2 {
        font-size: 2.5rem;
        margin-bottom: 12px;
        font-weight: 800;
        background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .trending-header p {
        font-size: 1.2rem;
        color: var(--text-secondary);
    }

    .trending-movies {
        display: flex;
        overflow-x: auto;
        gap: 24px;
        padding: 20px 0;
        scrollbar-width: thin;
        scrollbar-color: var(--glass-border) transparent;
    }

    .trending-movies::-webkit-scrollbar {
        height: 8px;
    }

    .trending-movies::-webkit-scrollbar-track {
        background: transparent;
    }

    .trending-movies::-webkit-scrollbar-thumb {
        background: var(--primary);
        border-radius: 20px;
    }

    .trending-card {
        min-width: 220px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        cursor: pointer;
        position: relative;
    }

    .trending-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--primary);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1;
    }

    .trending-card:hover {
        transform: translateY(-10px) scale(1.05);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
    }

    .trending-card:hover::before {
        opacity: 0.1;
    }

    .trending-poster {
        width: 100%;
        height: 320px;
        object-fit: cover;
        transition: transform 0.6s ease;
    }

    .trending-card:hover .trending-poster {
        transform: scale(1.1);
    }

    .trending-info {
        padding: 20px;
        position: relative;
        z-index: 2;
    }

    .trending-title {
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 8px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .trending-meta {
        display: flex;
        justify-content: space-between;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .trending-rating {
        color: #ffd700;
        font-weight: 600;
    }

    /* Enhanced Header */
    header {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--glass-border);
        position: fixed;
        width: 100%;
        z-index: 1000;
        padding: 16px 0;
        transition: all 0.4s ease;
    }

    .header-scrolled {
        background: rgba(0, 0, 0, 0.95);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        padding: 12px 0;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .logo h1 {
        background: var(--primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-size: 32px;
        font-weight: 800;
        letter-spacing: 2px;
        text-shadow: 0 0 20px rgba(59, 147, 195, 0.3);
    }

    nav ul {
        display: flex;
        list-style: none;
        gap: 32px;
    }

    nav ul li a {
        color: var(--text);
        text-decoration: none;
        font-weight: 600;
        font-size: 1.1rem;
        transition: all 0.3s ease;
        position: relative;
        padding: 8px 0;
    }

    nav ul li a::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 3px;
        background: var(--primary);
        transition: width 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        border-radius: 2px;
    }

    nav ul li a:hover::after, nav ul li a.active::after {
        width: 100%;
    }

    nav ul li a:hover, nav ul li a.active {
        color: #16dcd4;
        text-shadow: 0 0 10px rgba(22, 220, 212, 0.3);
    }

    /* Search Bar */
    .search-container {
        position: relative;
        margin: 0 20px;
    }

    .search-input {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 25px;
        padding: 10px 20px;
        color: var(--text);
        width: 300px;
        transition: all 0.3s ease;
    }

    .search-input:focus {
        width: 400px;
        box-shadow: 0 0 20px rgba(59, 147, 195, 0.2);
    }

    .search-results {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        margin-top: 8px;
        max-height: 300px;
        overflow-y: auto;
        display: none;
        z-index: 1000;
    }

    .search-results.active {
        display: block;
    }

    .search-result-item {
        padding: 12px 16px;
        border-bottom: 1px solid var(--glass-border);
        cursor: pointer;
        transition: background 0.3s ease;
    }

    .search-result-item:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    .search-result-item:last-child {
        border-bottom: none;
    }

    /* Enhanced User Menu */
    .user-menu {
        display: flex;
        align-items: center;
        cursor: pointer;
        position: relative;
        padding: 8px 16px;
        border-radius: 50px;
        transition: all 0.3s ease;
    }

    .user-menu:hover {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
    }

    .user-menu a {
        color: var(--light);
        padding-left: 16px;
        font-weight: 600;
        font-size: 1.1rem;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .user-menu a:hover {
        color: #16dcd4;
    }

    .user-avatar {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background: var(--primary);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 12px;
        font-weight: 800;
        color: white;
        transition: all 0.3s ease;
        font-size: 1.2rem;
    }

    .user-avatar:hover {
        transform: scale(1.1);
        box-shadow: 0 0 20px rgba(59, 147, 195, 0.4);
    }

    .user-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        width: 220px;
        padding: 12px 0;
        display: none;
        animation: fadeInUp 0.3s ease;
        margin-top: 8px;
    }

    .user-dropdown.active {
        display: block;
    }

    .user-dropdown a {
        display: block;
        padding: 12px 20px;
        color: var(--text);
        text-decoration: none;
        transition: all 0.3s ease;
        font-weight: 500;
    }

    .user-dropdown a:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #16dcd4;
        padding-left: 24px;
    }

    /* Enhanced Hero Section */
    .hero {
        height: 85vh;
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        padding-top: 80px;
        position: relative;
    }

    .hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(circle at 30% 70%, rgba(59, 147, 195, 0.2) 0%, transparent 50%);
        pointer-events: none;
    }

    .hero-content {
        padding-inline-start: 9px;
        margin-top: 10rem;
        max-width: 700px;
        z-index: 2;
        position: relative;
        animation: fadeInUp 1s ease-out 0.5s both;
    }

    .hero h2 {
        font-size: 3.5rem;
        margin-bottom: 24px;
        line-height: 1.2;
        font-weight: 800;
        background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 4px 20px rgba(255, 255, 255, 0.1);
    }

    .hero p {
        font-size: 1.3rem;
        margin-bottom: 32px;
        color: var(--text-secondary);
        line-height: 1.6;
        font-weight: 400;
    }

    .btn-hero {
        background: var(--primary);
        color: var(--light);
        padding: 16px 40px;
        font-size: 1.2rem;
        border-radius: 50px;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 12px;
        font-weight: 700;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .btn-hero:hover {
        background: var(--primary-dark);
        transform: translateY(-4px) scale(1.05);
        box-shadow: 0 15px 40px rgba(59, 147, 195, 0.4);
    }

    /* Enhanced Section Styles */
    section {
        padding: 80px 0;
        position: relative;
    }

    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 40px;
    }

    .section-title {
        font-size: 2.2rem;
        font-weight: 800;
        background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .view-all {
        color: #16dcd4;
        text-decoration: none;
        font-weight: 600;
        font-size: 1.1rem;
        transition: all 0.3s ease;
        position: relative;
    }

    .view-all::after {
        content: '→';
        margin-left: 8px;
        transition: transform 0.3s ease;
    }

    .view-all:hover {
        text-shadow: 0 0 10px rgba(22, 220, 212, 0.3);
    }

    .view-all:hover::after {
        transform: translateX(5px);
    }

    /* Enhanced Movie Grid */
    .movie-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 28px;
    }

    .movie-card {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        cursor: pointer;
        position: relative;
    }

    .movie-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--primary);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1;
        border-radius: 20px;
    }

    .movie-card:hover {
        transform: translateY(-15px) scale(1.05);
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
    }

    .movie-card:hover::before {
        opacity: 0.1;
    }

    .movie-poster {
        width: 100%;
        height: 320px;
        object-fit: cover;
        transition: transform 0.6s ease;
    }

    .movie-card:hover .movie-poster {
        transform: scale(1.1);
    }

    .movie-info {
        padding: 20px;
        position: relative;
        z-index: 2;
    }

    .movie-title {
        font-size: 1.2rem;
        font-weight: 700;
        margin-bottom: 8px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .movie-meta {
        display: flex;
        justify-content: space-between;
        color: var(--text-secondary);
        font-size: 0.95rem;
        font-weight: 500;
    }

    .movie-rating {
        color: #ffd700;
        font-weight: 700;
    }

    /* Enhanced Categories */
    .categories {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-bottom: 40px;
        justify-content: center;
    }

    .category {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        padding: 12px 24px;
        border-radius: 50px;
        font-size: 0.95rem;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .category:hover, .category.active {
        background: var(--primary);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(59, 147, 195, 0.3);
    }

    /* Enhanced Subscription Plans */
    .plans {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 32px;
        margin-top: 50px;
    }

    .plans .btn-primary:hover{
        color: var(--gray-light);
    }

    .plan {
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border: 1px solid var(--glass-border);
        border-radius: 24px;
        padding: 40px;
        text-align: center;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
        overflow: hidden;
    }

    .plan::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--primary);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1;
    }

    .plan:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .plan:hover::before {
        opacity: 0.05;
    }

    .plan.recommended {
        border-color: #3b93c3;
        position: relative;
    }

    .plan.recommended::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(59, 147, 195, 0.1) 0%, rgba(22, 220, 212, 0.1) 100%);
        pointer-events: none;
        border-radius: 24px;
    }

    .recommended-badge {
        position: relative;
        left: 50%;
        transform: translateX(-50%);
        background: var(--primary);
        color: white;
        padding: 8px 24px;
        border-radius: 50px;
        font-size: 0.85rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        z-index: 2;
    }

    .plan-name {
        font-size: 1.8rem;
        margin-bottom: 16px;
        font-weight: 800;
        z-index: 2;
        position: relative;
    }

    .plan-price {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 24px;
        background: var(--primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        z-index: 2;
        position: relative;
    }

    .plan-price span {
        font-size: 1.1rem;
        color: var(--text-secondary);
        font-weight: 500;
    }

    .plan-features {
        list-style: none;
        margin-bottom: 32px;
        z-index: 2;
        position: relative;
    }

    .plan-features li {
        padding: 12px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        font-weight: 500;
    }

    .plan-features li:last-child {
        border-bottom: none;
    }

    .plan-features li::before {
        content: '✓';
        color: #4ecdc4;
        font-weight: bold;
        margin-right: 12px;
    }

    /* Enhanced Footer */
    footer {
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(26, 26, 26, 0.95) 100%);
        padding: 60px 0 30px;
        border-top: 1px solid var(--glass-border);
        position: relative;
    }

    footer::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(circle at 50% 0%, rgba(59, 147, 195, 0.05) 0%, transparent 50%);
        pointer-events: none;
    }

    .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 40px;
        margin-bottom: 40px;
    }

    .footer-column h3 {
        color: var(--light);
        font-size: 1.3rem;
        margin-bottom: 20px;
        font-weight: 700;
    }

    .footer-links {
        list-style: none;
    }

    .footer-links li {
        margin-bottom: 12px;
    }

    .footer-links a {
        color: var(--text-secondary);
        text-decoration: none;
        transition: all 0.3s ease;
        font-weight: 500;
    }

    .footer-links a:hover {
        color: #16dcd4;
        padding-left: 8px;
    }

    .social-links {
        display: flex;
        gap: 16px;
        margin-top: 20px;
    }

    .social-links a {
        color: var(--text);
        font-size: 1.4rem;
        transition: all 0.3s ease;
        padding: 12px;
        border-radius: 50%;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
    }

    .social-links a:hover {
        color: #16dcd4;
        transform: translateY(-4px) scale(1.1);
        box-shadow: 0 8px 25px rgba(22, 220, 212, 0.3);
    }

    .copyright {
        text-align: center;
        padding-top: 30px;
        border-top: 1px solid var(--glass-border);
        color: var(--text-secondary);
        font-size: 0.95rem;
    }

    /* Owner Dashboard */
    .owner-dashboard {
        background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #0f0f0f 100%);
        min-height: 100vh;
    }

    .owner-header {
        position: sticky;
        top: 0;
        z-index: 9999;
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border-bottom: 1px solid var(--glass-border);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        padding: 3px 0;
    }

    .owner-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .owner-content {
        display: grid;
        grid-template-columns: 280px 1fr;
        min-height: calc(100vh - 80px);
    }

    .owner-sidebar {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-right: 1px solid var(--glass-border);
        padding: 24px 0;
    }

    .owner-menu {
        list-style: none;
    }

    .owner-menu li {
        margin-bottom: 8px;
    }

    .owner-menu a {
        display: flex;
        align-items: center;
        padding: 16px 24px;
        color: var(--text);
        text-decoration: none;
        transition: all 0.3s ease;
        font-weight: 500;
        border-radius: 0 50px 50px 0;
        margin-right: 24px;
    }

    .owner-menu a:hover, .owner-menu a.active {
        background: var(--primary);
        color: white;
        transform: translateX(8px);
    }

    .owner-menu i {
        margin-right: 12px;
        width: 20px;
        text-align: center;
    }

    .owner-main-content {
        padding: 30px;
    }

    /* Enhanced Stats Cards */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 24px;
        margin-bottom: 40px;
    }

    .stat-card {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        padding: 24px;
        border-radius: 20px;
        text-align: center;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
    }

    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--primary);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
    }

    .stat-card:hover::before {
        opacity: 0.1;
    }

    .stat-card i {
        color: #16dcd4;
        margin-bottom: 12px;
        z-index: 2;
        position: relative;
    }

    .stat-value {
        font-size: 2.5rem;
        font-weight: 800;
        margin: 12px 0;
        background: var(--primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        z-index: 2;
        position: relative;
    }

    .stat-title {
        color: var(--text-secondary);
        font-size: 0.95rem;
        font-weight: 600;
        z-index: 2;
        position: relative;
    }

    /* Movie Upload Form */
    .movie-upload-form {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        padding: 30px;
        border-radius: 20px;
        margin-bottom: 30px;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
    }

    /* Upload Status */
    .upload-status {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        padding: 30px;
        border-radius: 20px;
        margin-bottom: 30px;
    }

    .status-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        margin-bottom: 10px;
    }

    .status-badge {
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
    }

    .status-pending {
        background: rgba(255, 193, 7, 0.2);
        color: #ffc107;
    }

    .status-processing {
        background: rgba(33, 150, 243, 0.2);
        color: #2196f3;
    }

    .status-approved {
        background: rgba(76, 175, 80, 0.2);
        color: #4caf50;
    }

    .status-rejected {
        background: rgba(244, 67, 54, 0.2);
        color: #f44336;
    }

    /* Admin Approval Pages */
    .approval-section {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        padding: 30px;
        border-radius: 20px;
        margin-bottom: 30px;
    }

    .approval-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        margin-bottom: 15px;
    }

    .approval-actions {
        display: flex;
        gap: 10px;
    }

    /* Enhanced Admin Panel */
    .admin-panel {
        background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #0f0f0f 100%);
        min-height: 100vh;
    }

    .admin-header {
        position: sticky;
        top: 0;
        z-index: 9999;
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border-bottom: 1px solid var(--glass-border);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        padding: 3px 0;
    }

    .admin-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .admin-content {
        display: grid;
        grid-template-columns: 280px 1fr;
        min-height: calc(100vh - 80px);
    }

    .sidebar {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-right: 1px solid var(--glass-border);
        padding: 24px 0;
    }

    .sidebar-menu {
        list-style: none;
    }

    .sidebar-menu li {
        margin-bottom: 8px;
    }

    .sidebar-menu a {
        display: flex;
        align-items: center;
        padding: 16px 24px;
        color: var(--text);
        text-decoration: none;
        transition: all 0.3s ease;
        font-weight: 500;
        border-radius: 0 50px 50px 0;
        margin-right: 24px;
    }

    .sidebar-menu a:hover, .sidebar-menu a.active {
        background: var(--primary);
        color: white;
        transform: translateX(8px);
    }

    .sidebar-menu i {
        margin-right: 12px;
        width: 20px;
        text-align: center;
    }

    .main-content {
        padding: 30px;
    }

    /* Enhanced Tables */
    .dashboard-table {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        overflow: hidden;
        margin-bottom: 32px;
        transition: all 0.3s ease;
    }

    .dashboard-table:hover {
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .table-header {
        padding: 24px;
        border-bottom: 1px solid var(--glass-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(255, 255, 255, 0.02);
    }

    .table-header h3 {
        font-size: 1.4rem;
        font-weight: 700;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 16px 24px;
        text-align: left;
        border-bottom: 1px solid var(--glass-border);
    }

    th {
        background: rgba(255, 255, 255, 0.05);
        font-weight: 700;
        color: var(--text);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-size: 0.9rem;
    }

    tr:last-child td {
        border-bottom: none;
    }

    tr {
        transition: background-color 0.3s ease;
    }

    tr:hover {
        background: rgba(255, 255, 255, 0.05);
    }

    /* Enhanced Status Badges */
    .status {
        padding: 6px 16px;
        border-radius: 50px;
        font-size: 0.8rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .status.active {
        background: rgba(76, 175, 80, 0.2);
        color: #4caf50;
        border: 1px solid rgba(76, 175, 80, 0.3);
    }

    .status.pending {
        background: rgba(255, 193, 7, 0.2);
        color: #ffc107;
        border: 1px solid rgba(255, 193, 7, 0.3);
    }

    .status.expired {
        background: rgba(244, 67, 54, 0.2);
        color: #f44336;
        border: 1px solid rgba(244, 67, 54, 0.3);
    }

    /* Enhanced Action Buttons */
    .action-btn {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        color: var(--text);
        cursor: pointer;
        margin-right: 8px;
        transition: all 0.3s ease;
        padding: 8px 12px;
        border-radius: 8px;
    }

    .action-btn:hover {
        color: #16dcd4;
        transform: scale(1.1);
        background: rgba(22, 220, 212, 0.1);
    }

    /* Enhanced Tabs */
    .tabs {
        display: flex;
        border-bottom: 1px solid var(--glass-border);
        margin-bottom: 24px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-radius: 12px 12px 0 0;
    }

    .tab {
        padding: 16px 24px;
        cursor: pointer;
        border-bottom: 3px solid transparent;
        transition: all 0.3s ease;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .tab.active {
        border-bottom: 3px solid #3b93c3;
        color: #3b93c3;
        background: rgba(59, 147, 195, 0.1);
    }

    .tab:hover:not(.active) {
        background: rgba(255, 255, 255, 0.05);
    }

    .tab-content {
        display: none;
        animation: fadeInUp 0.5s ease;
    }

    .tab-content.active {
        display: block;
    }

    /* Enhanced File Upload */
    .file-upload {
        position: relative;
        overflow: hidden;
        display: inline-block;
        width: 100%;
    }

    .file-upload-btn {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 2px dashed var(--glass-border);
        color: var(--text);
        padding: 20px 32px;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
    }

    .file-upload-btn:hover {
        border-color: #3b93c3;
        background: rgba(59, 147, 195, 0.1);
    }

    .file-upload-btn::before {
        content: '📁';
        font-size: 1.5rem;
    }

    .file-upload input[type=file] {
        position: absolute;
        top: 0;
        right: 0;
        min-width: 100%;
        min-height: 100%;
        font-size: 100px;
        text-align: right;
        filter: alpha(opacity=0);
        opacity: 0;
        outline: none;
        background: white;
        cursor: pointer;
        display: block;
    }

    .file-name {
        margin-top: 12px;
        font-size: 0.9rem;
        color: var(--text-secondary);
        font-style: italic;
    }

    /* Enhanced Movie Details */
    .movie-details {
        padding-top: 100px;
        min-height: 100vh;
        background: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), var(--movie-background);
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
    }

    .movie-details-content {
        display: grid;
        grid-template-columns: 1fr 2fr;
        gap: 50px;
        align-items: start;
    }

    .movie-poster-large {
        width: 100%;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        transition: transform 0.3s ease;
    }

    .movie-poster-large:hover {
        transform: scale(1.02);
    }

    .movie-info-detailed {
        padding: 20px;
    }

    .movie-info-detailed h1 {
        font-size: 3rem;
        margin-bottom: 20px;
        font-weight: 800;
        background: linear-gradient(135deg, #ffffff 0%, #e0e0e0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .movie-meta-detailed {
        display: flex;
        gap: 24px;
        margin-bottom: 24px;
        color: var(--text-secondary);
        font-weight: 600;
    }

    .movie-description {
        margin-bottom: 32px;
        line-height: 1.8;
        font-size: 1.1rem;
        color: var(--text-secondary);
    }

    .movie-actions {
        display: flex;
        gap: 16px;
        margin-bottom: 40px;
    }

    .movie-actions .btn {
        padding: 16px 32px;
        border-radius: 50px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    /* Enhanced Cast Grid */
    .cast-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 24px;
        margin-top: 40px;
    }

    .cast-member {
        text-align: center;
        transition: transform 0.3s ease;
    }

    .cast-member:hover {
        transform: translateY(-8px);
    }

    .cast-photo {
        width: 100%;
        height: 220px;
        object-fit: cover;
        border-radius: 16px;
        margin-bottom: 12px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
    }

    .cast-member h4 {
        font-weight: 700;
        margin-bottom: 4px;
    }

    .cast-member p {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    /* Enhanced Browse Filters */
    .browse-filters {
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border: 1px solid var(--glass-border);
        padding: 24px;
        border-radius: 20px;
        margin-bottom: 40px;
        transition: all 0.3s ease;
    }

    .browse-filters:hover {
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .filter-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px;
        margin-bottom: 16px;
    }

    /* Enhanced Pagination */
    .pagination {
        display: flex;
        justify-content: center;
        margin-top: 40px;
        gap: 12px;
    }

    .page-btn {
        padding: 12px 20px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        color: var(--text);
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
    }

    .page-btn.active {
        background: var(--primary);
        color: white;
    }

    .page-btn:hover:not(.active) {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-2px);
    }

    /* Mobile Menu Button */
    .mobile-menu-btn {
        display: none;
        background: none;
        border: none;
        color: var(--text);
        font-size: 1.8rem;
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    .mobile-menu-btn:hover {
        background: var(--glass);
        color: #16dcd4;
    }

    /* Enhanced Video Player */
    .video-player-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.95);
        z-index: 10000;
        display: none;
        align-items: center;
        justify-content: center;
    }

    .video-player-overlay.active {
        display: flex;
    }

    .video-player-container {
        width: 90%;
        max-width: 1200px;
        background: var(--dark);
        border-radius: 12px;
        overflow: hidden;
        position: relative;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
    }

    .video-title {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%);
        color: white;
        padding: 20px;
        font-size: 1.5rem;
        font-weight: 600;
        z-index: 10;
    }

    .video-player {
        width: 100%;
        height: auto;
        display: block;
        background: #000;
    }

    .video-controls {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        z-index: 10;
        flex-wrap: wrap;
    }

    .close-video {
        position: absolute;
        top: 15px;
        right: 15px;
        background: rgba(0, 0, 0, 0.7);
        border: none;
        color: white;
        font-size: 1.5rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 11;
        transition: all 0.3s ease;
    }

    .close-video:hover {
        background: rgba(0, 0, 0, 0.9);
        transform: scale(1.1);
    }

    .manual-play-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
    }

    .manual-play-btn:hover {
        background: var(--primary-dark);
        transform: scale(1.05);
    }

    /* Video loading state */
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 1.2rem;
    }

    /* Theme Toggle */
    .theme-toggle {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 50px;
        padding: 8px 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-left: 15px;
    }

    .theme-toggle:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    /* Intersection Observer Animation */
    .fade-in-up {
        opacity: 0;
        transform: translateY(50px);
        transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .fade-in-up.visible {
        opacity: 1;
        transform: translateY(0);
    }

    /* Loading States */
    .loading-shimmer {
        background: linear-gradient(90deg, var(--glass) 25%, rgba(255, 255, 255, 0.1) 50%, var(--glass) 75%);
        background-size: 200% 100%;
        animation: shimmer 2s infinite;
    }

    /* Smooth Page Transitions */
    .page-transition {
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .page-transition.active {
        opacity: 1;
        transform: translateY(0);
    }

    /* Enhanced Hover Effects */
    .hover-glow:hover {
        box-shadow: 0 0 30px rgba(59, 147, 195, 0.4);
    }

    .hover-lift:hover {
        transform: translateY(-5px);
    }

    /* Enhanced Focus States */
    *:focus-visible {
        outline: 2px solid #16dcd4;
        outline-offset: 2px;
    }

    /* Print Styles */
    @media print {
        .user-page-bg, .bg-video, .user-menu, .btn-hero, .btn-get-started, 
        .btn-primary, .btn-secondary, .view-all, .movie-actions, 
        .action-btn, .pagination, .social-links, .admin-header,
        .no-print {
            display: none !important;
        }
        
        body {
            background: white !important;
            color: black !important;
        }
        
        .container {
            max-width: 100% !important;
        }
    }

    /* NEW Badge for recently added movies */
    .movie-card {
        position: relative;
    }

    .new-badge {
        position: absolute;
        top: 12px;
        right: 12px;
        background: var(--primary);
        color: white;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        z-index: 3;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        animation: pulse 2s infinite;
    }

    .movie-card-inner {
        position: relative;
        height: 100%;
    }

    /* PHASE 2 FEATURES - CSS ADDITIONS */

    /* Downloaded Badge */
    .downloaded-badge {
        position: absolute;
        top: 12px;
        left: 12px;
        background: linear-gradient(135deg, #4CAF50, #45a049);
        color: white;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 700;
        z-index: 3;
        display: flex;
        align-items: center;
        gap: 6px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        animation: pulse 2s infinite;
    }

    .downloaded-badge i {
        font-size: 0.9rem;
    }

    /* Movie Actions Container */
    .movie-actions {
        display: flex;
        gap: 10px;
        margin-top: 15px;
        flex-wrap: wrap;
    }

    .movie-actions .btn-secondary {
        padding: 10px 16px;
        font-size: 0.9rem;
        flex: 1;
        min-width: 120px;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    .movie-actions .btn-secondary i {
        font-size: 0.9rem;
    }

    /* Download Progress */
    .download-progress {
        width: 100%;
        height: 6px;
        background: var(--glass-border);
        border-radius: 3px;
        margin: 10px 0;
        overflow: hidden;
    }

    .download-progress-fill {
        height: 100%;
        background: linear-gradient(135deg, #3b93c3, #16dcd4);
        border-radius: 3px;
        transition: width 0.3s ease;
    }

    /* Family Members */
    .family-member {
        padding: 15px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
    }

    .family-member:hover {
        transform: translateX(5px);
        background: rgba(255, 255, 255, 0.05);
    }

    .family-member button {
        padding: 8px 12px;
        font-size: 0.85rem;
    }

    /* Advanced Search Filters */
    .filter-checkbox-label {
        display: inline-flex;
        align-items: center;
        margin: 5px 10px 5px 0;
        padding: 10px 15px;
        background: var(--glass);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
        user-select: none;
    }

    .filter-checkbox-label:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-2px);
    }

    .filter-checkbox-label input[type="checkbox"] {
        margin-right: 10px;
        width: 18px;
        height: 18px;
        cursor: pointer;
    }

    .filter-checkbox-label input[type="checkbox"]:checked {
        accent-color: #3b93c3;
    }

    .filter-options {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 15px;
    }

    .filter-section {
        margin-bottom: 25px;
        padding-bottom: 20px;
        border-bottom: 1px solid var(--glass-border);
    }

    .filter-section:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
    }

    .filter-section h3 {
        font-size: 1.2rem;
        margin-bottom: 15px;
        color: var(--text);
        font-weight: 600;
    }

    /* Search Filter Button */
    .search-filter-btn {
        background: var(--glass);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        color: var(--text);
        padding: 10px 14px;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 10px;
    }

    .search-filter-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: scale(1.05);
    }

    .search-filter-btn i {
        font-size: 1rem;
    }

    /* Recommendation Section */
    .recommendation-explanation {
        background: var(--glass);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        padding: 20px;
        margin-top: 20px;
        animation: fadeInUp 0.5s ease;
    }

    .recommendation-explanation h4 {
        margin-bottom: 10px;
        color: var(--text);
        font-size: 1.1rem;
    }

    .recommendation-explanation p {
        color: var(--text-secondary);
        line-height: 1.6;
    }

    /* Downloads Page */
    .downloads-grid {
        display: grid;
        gap: 20px;
    }

    .download-card {
        background: var(--glass);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .download-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .storage-info {
        background: var(--glass);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        padding: 25px;
        margin-bottom: 30px;
    }

    .storage-info h3 {
        margin-bottom: 15px;
        color: var(--text);
        font-size: 1.3rem;
    }

    .storage-bar {
        height: 10px;
        background: var(--glass-border);
        border-radius: 5px;
        margin: 15px 0;
        overflow: hidden;
    }

    .storage-fill {
        height: 100%;
        background: linear-gradient(135deg, #3b93c3, #16dcd4);
        border-radius: 5px;
        transition: width 0.5s ease;
    }

    /* Enhanced Mobile-First Responsive Design */

    /* Base Mobile Styles */
    @media (max-width: 767px) {
        /* Improved Mobile Navigation */
        .mobile-menu-btn {
            display: flex !important;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 1001;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
        }

        .header-content {
            flex-direction: column;
            align-items: flex-start;
            padding: 16px 0;
        }

        /* UPDATED: Mobile Navigation with Search and User in Nav */
        nav ul {
            display: none;
            flex-direction: column;
            width: 100%;
            background: #0a0a0a !important;
            border: 2px solid #1a1a1a !important;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 16px 0;
            border-radius: 0 0 16px 16px;
            margin-top: 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8);
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
        }

        nav ul.active {
            display: flex !important;
            animation: slideDown 0.3s ease-out;
        }

        /* NEW: Mobile Search Container */
        .mobile-search {
            order: 1 !important;
            margin: 0 16px 16px 16px !important;
            width: calc(100% - 32px) !important;
            display: block !important;
        }

        .mobile-search .search-input {
            width: 100% !important;
            padding: 14px 20px;
            font-size: 16px;
            background: #1a1a1a !important;
            border: 1px solid #333 !important;
            border-radius: 12px;
            color: var(--text);
        }

        .mobile-search .search-input:focus {
            width: 100% !important;
            border-color: #3b93c3 !important;
            box-shadow: 0 0 10px rgba(59, 147, 195, 0.3);
        }

        .mobile-search .search-results {
            width: calc(100% - 32px) !important;
            left: 0 !important;
            right: 0 !important;
            background: #1a1a1a !important;
            border: 1px solid #333 !important;
        }

        /* NEW: Mobile User Menu */
        .mobile-user-menu {
            order: 2 !important;
            margin: 0 16px 16px 16px !important;
            width: calc(100% - 32px) !important;
            display: flex !important;
            align-items: center;
            padding: 12px 16px !important;
            border-radius: 12px;
            background: #1a1a1a !important;
            border: 1px solid #333 !important;
            cursor: pointer;
        }

        .mobile-user-menu:hover {
            background: #252525 !important;
        }

        .mobile-user-menu .user-avatar {
            width: 36px !important;
            height: 36px !important;
            font-size: 1rem !important;
            margin-right: 12px;
        }

        .mobile-user-menu span {
            color: var(--text);
            font-weight: 600;
            font-size: 1rem;
            flex: 1;
        }

        .mobile-user-menu .user-dropdown {
            position: static !important;
            width: 100% !important;
            background: #1a1a1a !important;
            border: 1px solid #333 !important;
            border-radius: 12px;
            margin: 8px 0 0 0 !important;
            box-shadow: none !important;
            display: none;
        }

        .mobile-user-menu .user-dropdown.active {
            display: block !important;
            animation: fadeInUp 0.3s ease;
        }

        .mobile-user-menu .user-dropdown a {
            padding: 12px 16px;
            border-bottom: 1px solid #333;
            color: var(--text);
            text-decoration: none;
            transition: all 0.3s ease;
            display: block;
        }

        .mobile-user-menu .user-dropdown a:hover {
            background: #252525;
            color: #16dcd4;
            padding-left: 20px;
        }

        .mobile-user-menu .user-dropdown a:last-child {
            border-bottom: none;
        }

        /* Navigation Links */
        nav ul li {
            margin: 0;
            width: 100%;
            order: 3;
        }

        nav ul li a {
            display: block;
            padding: 16px 24px;
            width: 100%;
            border-radius: 0;
            font-size: 1.1rem;
            background: transparent !important;
            transition: all 0.3s ease;
            border-bottom: 1px solid #1a1a1a;
            order: 3;
        }

        nav ul li a:hover {
            background: #1a1a1a !important;
            color: #16dcd4 !important;
            transform: translateX(8px);
        }

        nav ul li a.active {
            background: linear-gradient(135deg, #3b93c3, #16dcd4) !important;
            color: white !important;
        }

        nav ul li:last-child a {
            border-bottom: none;
        }

        /* Hide original search and user menu from header in mobile */
        .header-content .search-container,
        .header-content .user-menu {
            display: none !important;
        }

        /* Improved Hero Section for Mobile */
        .hero {
            height: auto;
            min-height: 70vh;
            padding: 120px 0 60px;
            text-align: center;
        }

        .hero h2 {
            font-size: 2.2rem;
            line-height: 1.3;
            margin-bottom: 20px;
        }

        .hero p {
            font-size: 1.1rem;
            margin-bottom: 24px;
        }

        .btn-hero {
            padding: 16px 32px;
            font-size: 1.1rem;
            width: 100%;
            max-width: 280px;
            justify-content: center;
        }

        /* Enhanced Movie Grids for Mobile */
        .movie-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            padding: 0 8px;
        }

        .movie-card {
            min-height: 280px;
        }

        .movie-poster {
            height: 200px;
        }

        .movie-info {
            padding: 12px;
        }

        .movie-title {
            font-size: 0.95rem;
            white-space: normal;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .movie-meta {
            font-size: 0.8rem;
            flex-direction: column;
            gap: 4px;
        }

        /* Improved Trending Section */
        .trending-movies {
            padding: 0 16px;
            gap: 16px;
        }

        .trending-card {
            min-width: 160px;
        }

        .trending-poster {
            height: 220px;
        }

        .trending-info {
            padding: 12px;
        }

        .trending-title {
            font-size: 0.9rem;
            white-space: normal;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Enhanced Forms for Mobile */
        .form-group {
            margin-bottom: 20px;
        }

        input, select, textarea {
            padding: 16px;
            font-size: 16px;
            min-height: 52px;
        }

        .btn {
            padding: 16px 24px;
            min-height: 52px;
            font-size: 1rem;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Improved Email Signup */
        .email-signup {
            flex-direction: column;
            width: 100%;
            padding: 8px;
            border-radius: 16px;
        }

        .email-signup input {
            border-radius: 12px;
            margin-bottom: 12px;
            font-size: 16px;
            min-height: 52px;
        }

        .btn-get-started {
            border-radius: 12px;
            width: 100%;
            min-height: 52px;
            font-size: 1.1rem;
        }

        /* Enhanced Movie Details Page */
        .movie-details-content {
            grid-template-columns: 1fr;
            gap: 24px;
            padding: 0 16px;
        }

        .movie-poster-large {
            max-width: 280px;
            margin: 0 auto;
        }

        .movie-info-detailed h1 {
            font-size: 2rem;
            text-align: center;
        }

        .movie-meta-detailed {
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            text-align: center;
        }

        .movie-actions {
            flex-direction: column;
            gap: 12px;
        }

        .movie-actions .btn {
            width: 100%;
        }

        /* Improved Cast Grid */
        .cast-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .cast-photo {
            height: 160px;
        }

        /* Enhanced Footer */
        .footer-content {
            grid-template-columns: 1fr;
            gap: 32px;
            text-align: center;
        }

        .social-links {
            justify-content: center;
        }

        /* Improved Video Player for Mobile */
        .video-player-container {
            width: 100%;
            height: 100%;
            border-radius: 0;
        }

        .video-controls {
            padding: 16px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .close-video {
            top: 10px;
            right: 10px;
            width: 36px;
            height: 36px;
        }

        /* Enhanced Typography for Mobile */
        .section-title {
            font-size: 1.8rem;
            text-align: center;
        }

        .section-header {
            flex-direction: column;
            gap: 16px;
            text-align: center;
        }

        .view-all {
            align-self: center;
        }

        /* Improved Categories */
        .categories {
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .category {
            font-size: 0.85rem;
            padding: 10px 16px;
            min-height: 40px;
        }

        /* Enhanced Login Modal */
        .login-modal {
            margin: 16px;
            padding: 24px;
            width: calc(100% - 32px);
        }

        .modal-header h2 {
            font-size: 1.8rem;
        }

        /* Improved Plans Section */
        .plans {
            grid-template-columns: 1fr;
            gap: 20px;
            padding: 0 16px;
        }

        .plan {
            padding: 24px;
        }

        .plan-price {
            font-size: 2.4rem;
        }

        /* Enhanced Admin Panel for Mobile */
        .admin-content {
            grid-template-columns: 1fr;
        }

        .sidebar {
            display: none;
        }

        .stats-grid {
            grid-template-columns: 1fr;
            gap: 16px;
        }

        .dashboard-table {
            overflow-x: auto;
        }

        table {
            min-width: 600px;
        }

        /* Enhanced Owner Dashboard for Mobile */
        .owner-content {
            grid-template-columns: 1fr;
        }

        .owner-sidebar {
            display: none;
        }

        /* Touch-friendly improvements */
        .movie-card, .trending-card, .category, .btn, .tab, .action-btn, .page-btn {
            min-height: 44px;
            cursor: pointer;
        }

        /* Prevent text selection on interactive elements */
        .btn, .category, .nav-link, .tab {
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        /* PHASE 2 Mobile Responsive */
        .movie-actions {
            flex-direction: column;
        }
        
        .movie-actions .btn-secondary {
            width: 100%;
        }
        
        .family-member {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }
        
        .family-member button {
            align-self: flex-end;
        }
        
        .download-card {
            flex-direction: column;
        }
        
        .download-card img {
            width: 100%;
            height: 200px;
        }
        
        .filter-options {
            gap: 5px;
        }
        
        .filter-checkbox-label {
            padding: 8px 12px;
            font-size: 0.85rem;
        }

        .login-hero h2{
            font-size: 2rem;
            text-align: center;
        }

        .login-hero p{
            font-size: 1.5rem;
            text-align: center;
        }

         .login-hero p .hero-subtitle {
            font-size: 1.5rem;
            text-align: center;
        }

        .auth-buttons {
            padding: 1px;
            margin-right: 1.3rem;
        }
    }

    /* Extra Small Devices (320px - 480px) */
    @media (max-width: 480px) {
        .container {
            padding: 0 12px;
        }

        .hero h2 {
            font-size: 1.8rem;
        }

        .movie-grid {
            grid-template-columns: 1fr;
            gap: 12px;
        }

        .trending-card {
            min-width: 140px;
        }

        .trending-poster {
            height: 180px;
        }

        .section-title {
            font-size: 1.6rem;
        }

        .cast-grid {
            grid-template-columns: 1fr;
        }

        .categories {
            gap: 6px;
        }

        .category {
            font-size: 0.8rem;
            padding: 8px 12px;
        }

        /* Improved spacing for very small screens */
        section {
            padding: 60px 0;
        }

        .hero {
            padding: 100px 0 40px;
        }
    }

    /* Tablet Optimizations (768px - 1024px) */
    @media (min-width: 768px) and (max-width: 1024px) {
        .movie-grid {
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .trending-card {
            min-width: 180px;
        }

        .movie-details-content {
            grid-template-columns: 300px 1fr;
            gap: 32px;
        }

        .plans {
            grid-template-columns: repeat(2, 1fr);
        }

        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    /* Enhanced Touch Interactions */
    @media (hover: none) and (pointer: coarse) {
        /* Remove hover effects for touch devices */
        .movie-card:hover,
        .trending-card:hover,
        .category:hover {
            transform: none;
        }

        /* Enhanced touch targets */
        .nav-link,
        .btn,
        .category,
        .action-btn {
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Improve scrolling performance */
        .movie-grid,
        .trending-movies {
            -webkit-overflow-scrolling: touch;
        }
    }

    /* High DPI Screen Optimizations */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
        .movie-poster,
        .trending-poster,
        .cast-photo {
            image-rendering: -webkit-optimize-contrast;
        }
    }

    /* Reduced Motion Support */
    @media (prefers-reduced-motion: reduce) {
        .movie-card,
        .trending-card,
        .btn,
        .category {
            transition: none !important;
            animation: none !important;
        }
    }

    /* Landscape Orientation Optimizations */
    @media (max-width: 767px) and (orientation: landscape) {
        .hero {
            min-height: 100vh;
            padding: 100px 0 40px;
        }

        .movie-grid {
            grid-template-columns: repeat(3, 1fr);
        }

        .movie-poster {
            height: 160px;
        }
    }

    /* NEW: Animation for mobile menu slide down */
    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    #my-list-page .section-title{
        padding: 2rem;
    }
    #profile-page .section-title{
        padding: 2rem;
    }

    /* Enhanced Button Styles */
    .btn-primary {
        background: var(--primary);
        color: var(--light);
        padding: 16px 32px;
        border-radius: 12px;
        border: none;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.4s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        position: relative;
        overflow: hidden;
    }

    .btn-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.6s;
    }

    .btn-primary:hover::before {
        left: 100%;
    }

    .btn-primary:hover {
        background: var(--primary-dark);
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(59, 147, 195, 0.4);
    }

    .btn-secondary {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        color: var(--text);
        padding: 16px 32px;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-right: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-2px);
    }

    /* Responsive video player */
    @media (max-width: 768px) {
        .video-player-container {
            width: 95%;
            height: auto;
        }
        
        .video-title {
            font-size: 1.2rem;
            padding: 15px;
        }
        
        .video-controls {
            padding: 15px;
            gap: 10px;
        }
        
        .close-video {
            top: 10px;
            right: 10px;
            width: 35px;
            height: 35px;
        }
    }

    /* PHASE 1 Features CSS */
    .resume-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10001;
    }

    .resume-content {
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border: 1px solid var(--glass-border);
        padding: 30px;
        border-radius: 20px;
        text-align: center;
        max-width: 400px;
        width: 90%;
    }

    .progress-bar {
        width: 100%;
        height: 6px;
        background: var(--glass-border);
        border-radius: 3px;
        margin: 20px 0;
        overflow: hidden;
    }

    .progress-fill {
        height: 100%;
        background: var(--primary);
        border-radius: 3px;
        transition: width 0.3s ease;
    }

    .resume-actions {
        display: flex;
        gap: 12px;
        margin-top: 20px;
    }

    .resume-actions .btn {
        flex: 1;
    }

    .skip-intro-btn {
        position: absolute;
        right: 20px;
        bottom: 80px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        border: 2px solid rgba(255, 255, 255, 0.3);
        padding: 12px 20px;
        border-radius: 25px;
        cursor: pointer;
        font-weight: 600;
        z-index: 10;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }

    .skip-intro-btn:hover {
        background: rgba(0, 0, 0, 0.9);
        border-color: rgba(255, 255, 255, 0.6);
        transform: translateY(-2px);
    }

    .skip-intro-btn.hidden {
        opacity: 0;
        pointer-events: none;
    }

    .quality-selector {
        position: absolute;
        bottom: 60px;
        right: 20px;
        background: rgba(0, 0, 0, 0.9);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        padding: 15px;
        min-width: 180px;
        z-index: 100;
        backdrop-filter: blur(20px);
    }

    .quality-selector.hidden {
        display: none;
    }

    .quality-options h4 {
        margin-bottom: 12px;
        color: var(--text);
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .quality-option {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.3s ease;
        margin-bottom: 5px;
    }

    .quality-option:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    .quality-option.active {
        background: rgba(59, 147, 195, 0.3);
    }

    .quality-option.active .fa-check {
        display: block;
        color: #16dcd4;
    }

    .quality-option .fa-check {
        display: none;
    }

    .quality-bitrate {
        font-size: 0.8rem;
        color: var(--text-secondary);
    }

    .quality-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--text);
        padding: 8px 16px;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .quality-btn:hover {
        background: rgba(255, 255, 255, 0.2);
    }

    .reviews-section {
        margin-top: 40px;
        padding-top: 30px;
        border-top: 1px solid var(--glass-border);
    }

    .reviews-stats {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .average-rating {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .rating-value {
        font-size: 2.5rem;
        font-weight: 800;
        background: var(--primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .stars {
        color: #ffd700;
        font-size: 1.2rem;
    }

    .review-count {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .review-item {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 15px;
    }

    .review-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 12px;
    }

    .reviewer-info {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .reviewer-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--primary);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 700;
    }

    .review-rating {
        color: #ffd700;
        font-size: 0.9rem;
        margin-top: 4px;
    }

    .review-date {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .review-text {
        line-height: 1.6;
        color: var(--text);
    }

    .no-reviews {
        text-align: center;
        color: var(--text-secondary);
        font-style: italic;
        padding: 40px 0;
    }

    /* Review Modal */
    .review-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10002;
    }

    .review-modal.hidden {
        display: none;
    }

    .review-modal-content {
        background: var(--glass);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 30px;
        max-width: 500px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
    }

    .rating-selector {
        margin-bottom: 20px;
    }

    .star-rating {
        display: flex;
        gap: 8px;
        margin: 10px 0;
        font-size: 1.5rem;
        color: #ffd700;
        cursor: pointer;
    }

    .rating-text {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .form-actions {
        display: flex;
        gap: 12px;
        margin-top: 20px;
    }

    .form-actions .btn {
        flex: 1;
    }

    .no-downloads p{
        padding-bottom: 20px;
    }

    .category-results {
    margin-top: 40px;
    animation: fadeInUp 0.5s ease;
    }

    .category-results h3 {
        font-size: 1.5rem;
        margin-bottom: 20px;
        color: var(--text);
        font-weight: 600;
    }

    .no-category-results {
        text-align: center;
        padding: 60px 20px;
        color: var(--text-secondary);
        font-style: italic;
    }

    .no-category-results i {
        font-size: 3rem;
        margin-bottom: 20px;
        opacity: 0.5;
    }

    .category-results-section {
    min-height: 400px;
    position: relative;
    }

    #no-category-selected {
        transition: all 0.3s ease;
    }

    #category-results-info {
        background: var(--glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 30px;
        animation: fadeInUp 0.5s ease;
    }

    .category.active {
        background: var(--primary);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(59, 147, 195, 0.3);
    }

    .category:hover {
        transform: translateY(-2px);
        transition: transform 0.3s ease;
    }
/* For mobile devices (phones, up to 768px) */
@media (max-width: 768px) {
  .features-section {
    padding: 30px 15px;
  }
  
  .feature {
    margin-bottom: 50px;
    padding: 15px 0;
    display: flex;
    flex-direction: column; /* Stack vertically */
    align-items: center; /* Center everything */
    text-align: center; /* Center text */
  }
  
  /* Make sure reverse feature displays the same as regular feature on mobile */
  .feature.reverse {
    flex-direction: column; /* Force column layout */
    align-items: center; /* Center everything */
    text-align: center; /* Center text */
  }
  
  .feature-content {
    width: 100%;
    max-width: 600px; /* Limit width for better readability */
    margin-bottom: 25px; /* Space between text and image */
  }
  
  /* Ensure reverse feature content behaves the same */
  .feature.reverse .feature-content {
    order: 1; /* Content comes first */
    margin-bottom: 25px;
  }
  
  .feature-content h3 {
    font-size: 1.5rem;
    margin-bottom: 12px;
  }
  
  .feature-content p {
    font-size: 1rem;
    margin-bottom: 15px;
    line-height: 1.5;
  }
  
  /* Center the image container */
  .feature-image {
    width: 100%;
    display: flex;
    justify-content: center;
    order: 2; /* Image comes second */
  }
  
  /* Ensure reverse feature image behaves the same */
  .feature.reverse .feature-image {
    order: 2; /* Image comes after content */
  }
  
  /* Ensure images are centered and responsive */
  .feature-image img {
    width: 100%;
    max-width: 500px;
    height: auto;
    display: block;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
}

/* For very small phones (up to 480px) */
@media (max-width: 480px) {
  .features-section {
    padding: 20px 10px;
  }
  
  .feature {
    margin-bottom: 40px;
    padding: 10px 0;
  }
  
  .feature.reverse {
    margin-bottom: 40px;
    padding: 10px 0;
  }
  
  .feature-content {
    margin-bottom: 20px;
  }
  
  .feature.reverse .feature-content {
    margin-bottom: 20px;
  }
  
  .feature-content h3 {
    font-size: 1.3rem;
  }
  
  .feature-content p {
    font-size: 0.95rem;
  }
  
  .feature-image img {
    max-width: 400px; /* Slightly smaller on very small screens */
  }
}

/* For tablets and desktop, you can optionally add responsive layout */
@media (min-width: 769px) {
  .feature {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 40px;
  }
  
  /* Only reverse on desktop/tablet */
  .feature.reverse {
    flex-direction: row-reverse;
  }
  
  .feature-content {
    flex: 1;
    text-align: left;
    margin-bottom: 0;
  }
  
  .feature-image {
    flex: 1;
    text-align: center;
  }
  
  .feature-content h3 {
    font-size: 2.2rem;
  }
  
  .feature-content p {
    font-size: 1.2rem;
  }
}
</style>
</head>
<body>
    <!-- Skip to Content Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Notification System -->
    <div id="notification" class="notification"></div>

    <!-- Video Player Overlay -->
    <div class="video-player-overlay" id="video-player-overlay">
        <div class="video-player-container">
            <button class="close-video" id="close-video">&times;</button>
            <div class="video-title" id="video-title">Movie Preview</div>
            <video class="video-player" id="video-player" controls>
                Your browser does not support the video tag.
            </video>
            <div class="video-controls">
                <!-- Quality selector will be added here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Login Page -->
    <div id="login-page" class="login-page">
        <div class="login-header">
            <div class="login-logo">
                <h1>AMVIEW</h1>
            </div>
            <div class="auth-buttons">
                <button class="btn-login-hero" id="show-login-modal">Sign In</button>
            </div>
        </div>
        
        <div class="login-content">
            <div class="login-hero">
                <h2>Unlimited movies, TV shows, and more.</h2>
                <p>Watch anywhere. Cancel anytime.</p>
                <p class="hero-subtitle">Ready to watch? Enter your email to create or restart your membership.</p>
                <div class="email-signup">
                    <input type="email" placeholder="Email address">
                    <button class="btn-get-started">Start Now <i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
        
        <div class="trending-section">
            <div class="container">
                <div class="trending-header">
                    <h2>Trending Now</h2>
                    <p>Discover what everyone is watching</p>
                </div>
                <div class="trending-movies" id="trending-login">
                    <!-- Trending movies will be loaded here -->
                </div>
            </div>
        </div>
        
        <div class="features-section">
            <div class="container">
                <div class="feature">
                    <div class="feature-content">
                        <h3>Enjoy on your TV.</h3>
                        <p>Watch on Smart TVs, Playstation, Xbox, Chromecast, Apple TV, Blu-ray players, and more.</p>
                    </div>
                    <div class="feature-image">
                        <img src="https://www.slashgear.com/img/gallery/4-picture-settings-to-optimize-your-samsung-tv-for-watching-movies/use-the-movie-picture-mode-1710268245.webp" alt="Watch movies on various devices including Smart TVs, gaming consoles, and streaming devices">
                    </div>
                </div>
                
                <div class="feature reverse">
                    <div class="feature-content">
                        <h3>Download your shows to watch offline.</h3>
                        <p>Save your favorites easily and always have something to watch.</p>
                    </div>
                    <div class="feature-image">
                        <img src="https://www.parents.com/thmb/IeNT7Frxfh8sIywVyVYFkbQjdBA=/750x0/filters:no_upscale():max_bytes(150000):strip_icc():format(webp)/90-shows-2000-528acb0250f84c119910b3a89e9e3185.jpg" alt="Download TV shows and movies to watch offline">
                    </div>
                </div>
                
                <div class="feature">
                    <div class="feature-content">
                        <h3>Watch everywhere.</h3>
                        <p>Stream unlimited movies and TV shows on your phone, tablet, laptop, and TV.</p>
                    </div>
                    <div class="feature-image">
                        <img src="https://media.istockphoto.com/id/1938340315/photo/african-american-woman-watching-online-content-on-smart-phone-in-public-transport.jpg?s=612x612&w=0&k=20&c=21vGL9cshMWtU80TOEzh1_iz6DUdwRIjuJdJn8tIB6w=" alt="Watch movies on multiple devices anywhere you go">
                    </div>
                </div>
            </div>
        </div>
        <div class="cta-section">
            <div class="container">
                <p>Ready to watch? Enter your email to create or restart your membership.</p>
                <div class="email-signup">
                    <input type="email" placeholder="Email address">
                    <button class="btn-get-started">Start Now <i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
        
        <footer class="login-footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-column">
                        <h4>Questions? Contact us.</h4>
                        <ul class="footer-links">
                            <li><a href="#">FAQ</a></li>
                            <li><a href="#">Help Center</a></li>
                            <li><a href="#">Account</a></li>
                            <li><a href="#">Media Center</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>More</h4>
                        <ul class="footer-links">
                            <li><a href="#">Investor Relations</a></li>
                            <li><a href="#">Jobs</a></li>
                            <li><a href="#">Ways to Watch</a></li>
                            <li><a href="#">Terms of Use</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>Legal</h4>
                        <ul class="footer-links">
                            <li><a href="#">Privacy</a></li>
                            <li><a href="#">Cookie Preferences</a></li>
                            <li><a href="#">Corporate Information</a></li>
                            <li><a href="#">Contact Us</a></li>
                        </ul>
                    </div>
                </div>
                <div class="copyright">
                    <p>&copy; 2023 AMVIEW. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Login/Signup Modal -->
    <div class="modal-overlay" id="login-modal">
        <div class="login-modal">
            <div class="modal-header">
                <h2 id="modal-title">Sign In</h2>
                <button class="close-modal" id="close-login-modal">&times;</button>
            </div>
            
            <!-- Tabs for Login/Signup -->
            <div class="auth-tabs">
                <button class="auth-tab active" data-form="login">Sign In</button>
                <button class="auth-tab" data-form="signup">Sign Up</button>
            </div>
            
            <!-- Login Form -->
            <form id="login-form" class="auth-form active">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="btn btn-login">Sign In</button>
            </form>
            
            <!-- Signup Form -->
            <form id="signup-form" class="auth-form">
                <!-- User Type Selection -->
                <div class="user-type-selection">
                    <div class="user-type-option" data-type="user">
                        <i class="fas fa-user"></i>
                        <div>Regular User</div>
                    </div>
                    <div class="user-type-option" data-type="owner">
                        <i class="fas fa-film"></i>
                        <div>Movie Owner</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="signup-name">Full Name</label>
                    <input type="text" id="signup-name" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" placeholder="Create a password" required minlength="6">
                    <div class="password-strength">
                        <div>Password strength: <span id="strength-text">Weak</span></div>
                        <div class="strength-bar">
                            <div class="strength-fill strength-weak"></div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="confirm-password">Confirm Password</label>
                    <input type="password" id="confirm-password" placeholder="Confirm your password" required>
                </div>
                
                <!-- Payment Method Selection (for Movie Owners) -->
                <div class="payment-method-selection" id="payment-method-section">
                    <h4>Select Payment Method</h4>
                    <div class="payment-option" data-method="mobile">
                        <i class="fas fa-mobile-alt"></i> Mobile Money
                    </div>
                    <div class="payment-option" data-method="bank">
                        <i class="fas fa-university"></i> Bank Transfer
                    </div>
                    
                    <!-- Mobile Money Options -->
                    <div class="mobile-money-options" id="mobile-money-options">
                        <h5>Select Mobile Money Provider</h5>
                        <div class="mobile-money-option" data-provider="mpesa">M-Pesa</div>
                        <div class="mobile-money-option" data-provider="tigopesa">Tigo Pesa</div>
                        <div class="mobile-money-option" data-provider="airtelmoney">Airtel Money</div>
                        <div class="mobile-money-option" data-provider="halopesa">Halo Pesa</div>
                        <div class="mobile-money-option" data-provider="ezypesa">Ezy Pesa</div>
                    </div>
                    
                    <!-- Bank Options -->
                    <div class="bank-options" id="bank-options">
                        <h5>Select Bank</h5>
                        <div class="bank-option" data-bank="nmb">NMB Bank</div>
                        <div class="bank-option" data-bank="crdb">CRDB Bank</div>
                        <div class="bank-option" data-bank="nbc">NBC Bank</div>
                        <div class="bank-option" data-bank="stanbic">Stanbic Bank</div>
                        <div class="bank-option" data-bank="equity">Equity Bank</div>
                        <div class="bank-option" data-bank="kcb">KCB Bank</div>
                        <div class="bank-option" data-bank="exim">Exim Bank</div>
                        <div class="bank-option" data-bank="baroda">Bank of Baroda</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="terms-agreement" required>
                        I agree to the <a href="#" class="terms-link">Terms of Service</a> and <a href="#" class="terms-link">Privacy Policy</a>
                    </label>
                </div>
                <button type="submit" class="btn btn-login">Create Account</button>
            </form>
        </div>
    </div>

    <!-- User Interface -->
    <div id="user-interface" class="hidden">
        <header id="main-header" role="banner">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <h1>AMVIEW</h1>
                    </div>
                    <button class="mobile-menu-btn" aria-label="Toggle navigation menu">
                        <i class="fas fa-bars"></i>
                    </button>
                    <nav aria-label="Main navigation">
                        <ul>
                            <li><a href="#" class="nav-link active" data-page="home">Home</a></li>
                            <li><a href="#" class="nav-link" data-page="browse">Browse</a></li>
                            <li><a href="#" class="nav-link" data-page="my-list">My List</a></li>
                            <li><a href="#" class="nav-link" data-page="downloads">Downloads</a></li>
                            <li><a href="#" class="nav-link" data-page="profile">Profile</a></li>
                        </ul>
                    </nav>
                    <div class="search-container">
                        <input type="text" class="search-input" placeholder="Search movies..." id="search-input">
                        <div class="search-results" id="search-results"></div>
                    </div>
                    <div class="user-menu">
                        <div class="user-avatar" id="user-avatar">U</div>
                        <span id="user-fullname">User</span>
                        <div class="user-dropdown">
                            <a href="#" class="nav-link" data-page="profile">Profile</a>
                            <a href="#" class="nav-link" data-page="my-list">My List</a>
                            <a href="#" class="nav-link" data-page="downloads">Downloads</a>
                            <a href="#" class="admin-logout-btn">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <main id="main-content" role="main">
            <!-- Home Page -->
            <div id="home-page" class="page active">
                <div class="user-page-bg">
                    <video autoplay muted loop playsinline class="bg-video">
                        <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
                    </video> 
                </div>
                <section class="hero">
                    <div class="container">
                        <div class="hero-content">
                            <h2>Unlimited Movies, TV Shows, and More.</h2>
                            <p>Watch anywhere. Cancel anytime. Ready to watch? Enter your email to create or restart your membership.</p>
                            <a href="#" class="btn-hero">Start Now <i class="fas fa-chevron-right"></i></a>
                        </div>
                    </div>
                </section>

                <!-- Recommendations Section (Added by Phase 2) -->
                <section id="recommended-movies-section">
                    <div class="container">
                        <div class="section-header">
                            <h2 class="section-title">Recommended For You</h2>
                            <a href="#" class="view-all" id="refresh-recommendations">Refresh</a>
                        </div>
                        <div class="movie-grid" id="recommended-movies">
                            <!-- Recommendations will be loaded here -->
                        </div>
                        <div class="recommendation-explanation" style="display: none;">
                            <h4>Why these recommendations?</h4>
                            <p id="recommendation-reason"></p>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="container">
                        <div class="section-header">
                            <h2 class="section-title">Trending Now</h2>
                            <a href="#" class="view-all">View All</a>
                        </div>
                        <div class="movie-grid" id="trending-movies">
                            <!-- Movie cards will be dynamically loaded here -->
                        </div>
                    </div>
                </section>

                <section>
                    <div class="container">
                        <div class="section-header">
                            <h2 class="section-title">New Releases</h2>
                            <a href="#" class="view-all">View All</a>
                        </div>
                        <div class="movie-grid" id="new-releases">
                            <!-- Movie cards will be dynamically loaded here -->
                        </div>
                    </div>
                </section>

               <section>
                    <div class="container">
                        <div class="section-header">
                            <h2 class="section-title">Browse by Category</h2>
                        </div>
                        <div class="categories">
                            <div class="category active">All</div>
                            <div class="category">Action</div>
                            <div class="category">Comedy</div>
                            <div class="category">Drama</div>
                            <div class="category">Horror</div>
                            <div class="category">Sci-Fi</div>
                            <div class="category">Romance</div>
                            <div class="category">Thriller</div>
                            <div class="category">Animation</div>
                            <div class="category">Documentary</div>
                        </div>
                        
                        <!-- Category Results Section -->
                        <div class="category-results-section" style="margin-top: 40px;">
                            <div id="category-results-info" style="margin-bottom: 20px; text-align: center;">
                                <!-- Results info will be displayed here -->
                            </div>
                            <div class="movie-grid" id="category-movies">
                                <!-- Movies will be loaded here when a category is selected -->
                            </div>
                            <div id="no-category-selected" style="text-align: center; padding: 60px 20px; color: var(--text-secondary);">
                                <i class="fas fa-film" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
                                <h3>Select a category to browse movies</h3>
                                <p>Click on any category above to see movies in that genre</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="container">
                        <div class="section-header">
                            <h2 class="section-title">Subscription Plans</h2>
                        </div>
                        <div class="plans">
                            <div class="plan">
                                <h3 class="plan-name">Basic</h3>
                                <div class="plan-price">TZS 9,999 <span>/month</span></div>
                                <ul class="plan-features">
                                    <li>HD Available</li>
                                    <li>1 Screen</li>
                                    <li>Watch on your laptop, TV, phone and tablet</li>
                                    <li>Unlimited movies and TV shows</li>
                                </ul>
                                <button class="btn-primary">Choose Plan</button>
                            </div>
                            <div class="plan recommended">
                                <div class="recommended-badge">Most Popular</div>
                                <h3 class="plan-name">Standard</h3>
                                <div class="plan-price">TZS 19,999 <span>/month</span></div>
                                <ul class="plan-features">
                                    <li>HD Available</li>
                                    <li>2 Screens</li>
                                    <li>Watch on your laptop, TV, phone and tablet</li>
                                    <li>Unlimited movies and TV shows</li>
                                    <li>Download and watch offline</li>
                                </ul>
                                <button class="btn-primary">Choose Plan</button>
                            </div>
                            <div class="plan">
                                <h3 class="plan-name">Premium</h3>
                                <div class="plan-price">TZS 29,999 <span>/month</span></div>
                                <ul class="plan-features">
                                    <li>Ultra HD Available</li>
                                    <li>4 Screens</li>
                                    <li>Watch on your laptop, TV, phone and tablet</li>
                                    <li>Unlimited movies and TV shows</li>
                                    <li>Download and watch offline</li>
                                    <li>No ads</li>
                                </ul>
                                <button class="btn-primary">Choose Plan</button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Browse Page -->
            <div id="browse-page" class="page hidden">
                <div class="user-page-bg"></div>
                <section style="padding-top: 100px;">
                    <div class="container">
                        <h1 class="section-title">Browse Movies</h1>
                        
                        <div class="browse-filters">
                            <div class="filter-row">
                                <div class="form-group">
                                    <label for="genre-filter">Genre</label>
                                    <select id="genre-filter">
                                        <option value="">All Genres</option>
                                        <option value="action">Action</option>
                                        <option value="comedy">Comedy</option>
                                        <option value="drama">Drama</option>
                                        <option value="horror">Horror</option>
                                        <option value="sci-fi">Sci-Fi</option>
                                        <option value="romance">Romance</option>
                                        <option value="thriller">Thriller</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="year-filter">Release Year</label>
                                    <select id="year-filter">
                                        <option value="">All Years</option>
                                        <option value="2023">2023</option>
                                        <option value="2022">2022</option>
                                        <option value="2021">2021</option>
                                        <option value="2020">2020</option>
                                        <option value="2019">2019</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="sort-by">Sort By</label>
                                    <select id="sort-by">
                                        <option value="popularity">Popularity</option>
                                        <option value="rating">Rating</option>
                                        <option value="newest">Newest</option>
                                        <option value="oldest">Oldest</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="movie-grid" id="browse-movies">
                            <!-- Movie cards will be dynamically loaded here -->
                        </div>
                        
                        <div class="pagination">
                            <button class="page-btn active">1</button>
                            <button class="page-btn">2</button>
                            <button class="page-btn">3</button>
                            <button class="page-btn">Next</button>
                        </div>
                    </div>
                </section>
            </div>

            <!-- My List Page -->
            <div id="my-list-page" class="page hidden">
                <div class="user-page-bg"></div>
                <section style="padding-top: 100px;">
                    <div class="container">
                        <h1 class="section-title">My List</h1>
                        <div class="movie-grid" id="my-list-movies">
                            <!-- Movie cards will be dynamically loaded here -->
                        </div>
                    </div>
                </section>
            </div>

            <!-- Downloads Page (Added by Phase 2) -->
            <div id="downloads-page" class="page hidden">
                <div class="user-page-bg"></div>
                <section style="padding-top: 100px;">
                    <div class="container">
                        <h1 class="section-title">My Downloads</h1>
                        
                        <div class="storage-info">
                            <h3>Storage Status</h3>
                            <div class="storage-bar">
                                <div class="storage-fill" style="width: 0%"></div>
                            </div>
                            <p id="storage-status">0 of 10 downloads used</p>
                        </div>
                        
                        <div class="downloads-grid" id="downloads-grid">
                            <!-- Downloads will be loaded here -->
                        </div>
                        
                        <div class="no-downloads" style="text-align: center; padding: 40px; display: none;">
                            <h3>No downloads yet</h3>
                            <p>Download movies to watch offline</p>
                            <a href="#" class="btn-primary" data-page="browse">Browse Movies</a>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Profile Page -->
            <div id="profile-page" class="page hidden">
                <div class="user-page-bg"></div>
                <section style="padding-top: 100px;">
                    <div class="container">
                        <h1 class="section-title">Profile</h1>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="profile-name">Full Name</label>
                                <input type="text" id="profile-name" value="Mubezi B. Christopher ">
                            </div>
                            <div class="form-group">
                                <label for="profile-email">Email</label>
                                <input type="email" id="profile-email" value="mubbie@amview.com" readonly>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="profile-subscription">Subscription Plan</label>
                            <input type="text" id="profile-subscription" value="Premium" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="profile-billing">Billing Date</label>
                            <input type="text" id="profile-billing" value="Next billing: December 15, 2023" readonly>
                        </div>
                        
                        <!-- Family Section (Added by Phase 2) -->
                        <div class="family-section" style="margin-top: 40px;">
                            <h3 style="margin-bottom: 20px;">Family Members</h3>
                            <div class="family-members-list" id="family-members-list">
                                <p>No family members added yet.</p>
                            </div>
                            
                            <h4 style="margin-top: 30px;">Add Family Member</h4>
                            <div class="add-family-member-form" style="background: var(--glass); padding: 20px; border-radius: 12px;">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="family-member-name">Name</label>
                                        <input type="text" id="family-member-name" placeholder="Enter family member name">
                                    </div>
                                    <div class="form-group">
                                        <label for="family-member-email">Email</label>
                                        <input type="email" id="family-member-email" placeholder="Enter family member email">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="family-member-relationship">Relationship</label>
                                    <select id="family-member-relationship">
                                        <option value="spouse">Spouse</option>
                                        <option value="child">Child</option>
                                        <option value="parent">Parent</option>
                                        <option value="sibling">Sibling</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <button class="btn-primary" id="add-family-member-btn">Add Family Member</button>
                            </div>
                            
                            <div class="family-settings" style="margin-top: 30px;">
                                <h4>Family Settings</h4>
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="kid-safe-mode">
                                        Enable Kid-Safe Mode for Children
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="watch-history-sharing">
                                        Share Watch History with Family
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn-primary" style="margin-top: 20px;">Save Changes</button>
                        <button class="btn-secondary logout-btn">Logout</button>
                    </div>
                </section>
            </div>

            <!-- Movie Details Page -->
            <div id="movie-details-page" class="page hidden">
                <div class="user-page-bg"></div>
                <section class="movie-details" id="movie-details-section">
                    <div class="container">
                        <div class="movie-details-content">
                            <div>
                                <img src="" alt="Movie Poster" class="movie-poster-large" id="detail-poster">
                            </div>
                            <div class="movie-info-detailed">
                                <h1 id="detail-title">Movie Title</h1>
                                <div class="movie-meta-detailed">
                                    <span id="detail-year">2023</span>
                                    <span id="detail-rating">8.5/10</span>
                                    <span id="detail-duration">2h 15m</span>
                                    <span id="detail-genre">Action, Adventure</span>
                                </div>
                                <p class="movie-description" id="detail-description">Movie description goes here.</p>
                                <div class="movie-actions">
                                    <button class="btn-primary" id="watch-now-btn"><i class="fas fa-play"></i> Watch Now</button>
                                    <button class="btn-secondary" id="download-movie-btn"><i class="fas fa-download"></i> Download</button>
                                    <button class="btn-secondary" id="add-to-list-btn"><i class="fas fa-plus"></i> My List</button>
                                </div>
                                
                                <h3>Cast</h3>
                                <div class="cast-grid" id="cast-grid">
                                    <!-- Cast members will be dynamically loaded here -->
                                </div>

                                <!-- Reviews Section (Added by Phase 1) -->
                                <div class="reviews-section">
                                    <h3>User Reviews</h3>
                                    <div class="reviews-stats">
                                        <div class="average-rating">
                                            <span class="rating-value">0.0</span>
                                            <div class="stars">
                                                <i class="far fa-star"></i>
                                                <i class="far fa-star"></i>
                                                <i class="far fa-star"></i>
                                                <i class="far fa-star"></i>
                                                <i class="far fa-star"></i>
                                            </div>
                                            <span class="review-count">0 reviews</span>
                                        </div>
                                        <button class="btn-primary write-review-btn">Write Review</button>
                                    </div>
                                    <div class="reviews-list" id="reviews-list">
                                        <div class="no-reviews">No reviews yet. Be the first to review this movie!</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <footer role="contentinfo">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-column">
                        <h3>AMVIEW</h3>
                        <ul class="footer-links">
                            <li><a href="#">About Us</a></li>
                            <li><a href="#">Careers</a></li>
                            <li><a href="#">Contact</a></li>
                            <li><a href="#">FAQ</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Legal</h3>
                        <ul class="footer-links">
                            <li><a href="#">Terms of Use</a></li>
                            <li><a href="#">Privacy Policy</a></li>
                            <li><a href="#">Cookie Policy</a></li>
                            <li><a href="#">Copyright</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Connect With Us</h3>
                        <div class="social-links">
                            <a href="#"><i class="fab fa-facebook-f"></i></a>
                            <a href="#"><i class="fab fa-twitter"></i></a>
                            <a href="#"><i class="fab fa-instagram"></i></a>
                            <a href="#"><i class="fab fa-youtube"></i></a>
                        </div>
                    </div>
                </div>
                <div class="copyright">
                    <p>&copy; 2023 AMVIEW. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Owner Dashboard -->
    <div id="owner-interface" class="owner-dashboard hidden">
        <div class="owner-header">
            <div class="container">
                <div class="owner-nav">
                    <div class="logo">
                        <h1>AMVIEW <small>Owner Dashboard</small></h1>
                    </div>
                    <div class="user-menu" id="owner-user-menu">
                        <div class="user-avatar">O</div>
                        <span id="owner-fullname">Owner User</span>
                        <a href="#" id="owner-logout-icon" title="Logout">
                            <i class="fa fa-sign-out" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="owner-content">
            <div class="owner-sidebar">
                <ul class="owner-menu">
                    <li><a href="#" class="owner-nav-link active" data-page="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="#" class="owner-nav-link" data-page="upload"><i class="fas fa-upload"></i> Upload Movie</a></li>
                    <li><a href="#" class="owner-nav-link" data-page="status"><i class="fas fa-tasks"></i> Upload Status</a></li>
                    <li><a href="#" class="owner-nav-link" data-page="movies"><i class="fas fa-film"></i> My Movies</a></li>
                </ul>
            </div>

            <div class="owner-main-content">
                <!-- Owner Dashboard -->
                <div id="owner-dashboard" class="owner-page active">
                    <h2>Owner Dashboard</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <i class="fas fa-film fa-2x"></i>
                            <div class="stat-value" id="owner-total-movies">0</div>
                            <div class="stat-title">Total Movies</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-check-circle fa-2x"></i>
                            <div class="stat-value" id="owner-approved-movies">0</div>
                            <div class="stat-title">Approved Movies</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-clock fa-2x"></i>
                            <div class="stat-value" id="owner-pending-movies">0</div>
                            <div class="stat-title">Pending Approval</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-times-circle fa-2x"></i>
                            <div class="stat-value" id="owner-rejected-movies">0</div>
                            <div class="stat-title">Rejected Movies</div>
                        </div>
                    </div>
                </div>

                <!-- Upload Movie Page -->
                <div id="owner-upload" class="owner-page hidden">
                    <h2>Upload New Movie</h2>
                    <div class="movie-upload-form">
                        <form id="upload-movie-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="movie-title">Movie Title *</label>
                                    <input type="text" id="movie-title" placeholder="Enter movie title" required>
                                </div>
                                <div class="form-group">
                                    <label for="release-year">Release Year *</label>
                                    <input type="number" id="release-year" placeholder="2023" min="1900" max="2030" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="genre">Genre *</label>
                                    <select id="genre" required>
                                        <option value="">Select Genre</option>
                                        <option value="action">Action</option>
                                        <option value="comedy">Comedy</option>
                                        <option value="drama">Drama</option>
                                        <option value="horror">Horror</option>
                                        <option value="sci-fi">Sci-Fi</option>
                                        <option value="romance">Romance</option>
                                        <option value="thriller">Thriller</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="language">Language *</label>
                                    <input type="text" id="language" placeholder="English" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="description">Description *</label>
                                <textarea id="description" rows="4" placeholder="Enter movie description" required></textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="duration">Duration (minutes) *</label>
                                    <input type="number" id="duration" placeholder="120" required>
                                </div>
                                <div class="form-group">
                                    <label for="rating">Rating *</label>
                                    <input type="number" id="rating" placeholder="8.5" min="0" max="10" step="0.1" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="poster-url">Poster Image URL</label>
                                <input type="text" id="poster-url" placeholder="Enter poster image URL">
                            </div>
                            <div class="form-group">
                                <label>Upload Movie File *</label>
                                <div class="file-upload">
                                    <button type="button" class="file-upload-btn">Choose File</button>
                                    <input type="file" id="movie-file" accept="video/*" required>
                                </div>
                                <div class="file-name" id="movie-file-name">No file chosen</div>
                            </div>
                            <button type="submit" class="btn btn-login">Upload Movie</button>
                        </form>
                    </div>
                </div>

                <!-- Upload Status Page -->
                <div id="owner-status" class="owner-page hidden">
                    <h2>Upload Status</h2>
                    <div class="upload-status">
                        <div id="upload-status-list">
                            <!-- Status items will be dynamically loaded here -->
                        </div>
                    </div>
                </div>

                <!-- My Movies Page -->
                <div id="owner-movies" class="owner-page hidden">
                    <h2>My Movies</h2>
                    <div class="movie-grid" id="owner-movies-grid">
                        <!-- Owner's movies will be dynamically loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Interface -->
    <div id="admin-interface" class="admin-panel hidden">
        <div class="admin-header">
            <div class="container">
                <div class="admin-nav">
                    <div class="logo">
                        <h1>AMVIEW <small>Admin</small></h1>
                    </div>
                    <div class="user-menu" id="admin-user-menu">
                        <div class="user-avatar">A</div>
                        <span>Admin User</span>
                        <a href="#" id="admin-logout-icon" title="Logout">
                            <i class="fa fa-sign-out" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="admin-content">
            <div class="sidebar">
                <ul class="sidebar-menu">
                    <li><a href="#" class="admin-nav-link active" data-page="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="#" class="admin-nav-link" data-page="movies"><i class="fas fa-film"></i> Movies</a></li>
                    <li><a href="#" class="admin-nav-link" data-page="owner-approvals"><i class="fas fa-user-check"></i> Owner Approvals</a></li>
                    <li><a href="#" class="admin-nav-link" data-page="movie-approvals"><i class="fas fa-video"></i> Movie Approvals</a></li>
                    <li><a href="#" class="admin-nav-link" data-page="users"><i class="fas fa-users"></i> Users</a></li>
                </ul>
            </div>

            <div class="main-content">
                <!-- Admin Dashboard -->
                <div id="admin-dashboard" class="admin-page active">
                    <h2>Dashboard Overview</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <i class="fas fa-users fa-2x"></i>
                            <div class="stat-value">12,458</div>
                            <div class="stat-title">Total Users</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-film fa-2x"></i>
                            <div class="stat-value">1,247</div>
                            <div class="stat-title">Total Movies</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-money-bill-wave fa-2x"></i>
                            <div class="stat-value">$24,589</div>
                            <div class="stat-title">Monthly Revenue</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-eye fa-2x"></i>
                            <div class="stat-value">245,687</div>
                            <div class="stat-title">Monthly Views</div>
                        </div>
                    </div>

                    <div class="dashboard-table">
                        <div class="table-header">
                            <h3>Recent Subscriptions</h3>
                            <a href="#" class="view-all">View All</a>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Plan</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>mubbie@aseriy.com</td>
                                    <td>Premium</td>
                                    <td>TZS 19,999/=</td>
                                    <td><span class="status active">Active</span></td>
                                    <td>
                                        <button class="action-btn"><i class="fas fa-edit"></i></button>
                                        <button class="action-btn"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                                <!-- More table rows would be here -->
                            </tbody>
                        </table>
                    </div>

                    <div class="dashboard-table">
                        <div class="table-header">
                            <h3>Latest Movies</h3>
                            <a href="#" class="view-all">View All</a>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Genre</th>
                                    <th>Year</th>
                                    <th>Rating</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="admin-movies-table">
                                <!-- Movies will be dynamically loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Owner Approvals Page -->
                <div id="admin-owner-approvals" class="admin-page hidden">
                    <h2>Movie Owner Account Approvals</h2>
                    <div class="approval-section">
                        <div id="owner-approval-list">
                            <!-- Owner approval items will be dynamically loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Movie Approvals Page -->
                <div id="admin-movie-approvals" class="admin-page hidden">
                    <h2>Movie Upload Approvals</h2>
                    <div class="approval-section">
                        <div id="movie-approval-list">
                            <!-- Movie approval items will be dynamically loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Advanced Search Modal (Added by Phase 2) -->
    <div id="advanced-search-modal" class="modal-overlay">
        <div class="login-modal" style="max-width: 600px;">
            <div class="modal-header">
                <h2>Advanced Search Filters</h2>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="filter-sections">
                <div class="filter-section">
                    <h3>Genre</h3>
                    <div class="filter-options">
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="action">
                            <span>Action</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="comedy">
                            <span>Comedy</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="drama">
                            <span>Drama</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="horror">
                            <span>Horror</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="sci-fi">
                            <span>Sci-Fi</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="romance">
                            <span>Romance</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="thriller">
                            <span>Thriller</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="animation">
                            <span>Animation</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="documentary">
                            <span>Documentary</span>
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" class="genre-filter" value="fantasy">
                            <span>Fantasy</span>
                        </label>
                    </div>
                </div>
                
                <div class="filter-section">
                    <h3>Release Year</h3>
                    <div class="year-range">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="year-from">From</label>
                                <select id="year-from">
                                    <option value="">Any</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                    <option value="2021">2021</option>
                                    <option value="2020">2020</option>
                                    <option value="2019">2019</option>
                                    <option value="2018">2018</option>
                                    <option value="2017">2017</option>
                                    <option value="2016">2016</option>
                                    <option value="2015">2015</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="year-to">To</label>
                                <select id="year-to">
                                    <option value="">Any</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                    <option value="2021">2021</option>
                                    <option value="2020">2020</option>
                                    <option value="2019">2019</option>
                                    <option value="2018">2018</option>
                                    <option value="2017">2017</option>
                                    <option value="2016">2016</option>
                                    <option value="2015">2015</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="filter-section">
                    <h3>Rating</h3>
                    <div class="rating-filter">
                        <div class="form-group">
                            <label for="min-rating">Minimum Rating</label>
                            <select id="min-rating">
                                <option value="0">Any</option>
                                <option value="5">5+</option>
                                <option value="6">6+</option>
                                <option value="7">7+</option>
                                <option value="8">8+</option>
                                <option value="9">9+</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="filter-section">
                    <h3>Duration</h3>
                    <div class="duration-filter">
                        <div class="form-group">
                            <label for="max-duration">Maximum Duration</label>
                            <select id="max-duration">
                                <option value="">Any</option>
                                <option value="60">Under 1 hour</option>
                                <option value="120">Under 2 hours</option>
                                <option value="180">Under 3 hours</option>
                                <option value="240">Under 4 hours</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="filter-actions" style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-primary" id="apply-filters">Apply Filters</button>
                <button class="btn-secondary" id="clear-filters">Clear All</button>
            </div>
        </div>
    </div>

<script>
// ============================================
// CORE DATA STRUCTURES
// ============================================

// Enhanced user data structure
let users = JSON.parse(localStorage.getItem('amviewUsers')) || [
    { 
        email: "mubbie@amview.com", 
        password: "password", 
        name: "Regular User", 
        role: "user", 
        joinDate: new Date().toISOString(), 
        subscription: "Premium", 
        lastLogin: new Date().toISOString() 
    },
    { 
        email: "owner@amview.com", 
        password: "password", 
        name: "Movie Owner", 
        role: "owner", 
        joinDate: new Date().toISOString(), 
        subscription: "Owner", 
        lastLogin: new Date().toISOString(),
        approved: true,
        paymentMethod: "mobile",
        paymentProvider: "mpesa"
    },
    { 
        email: "admin@amview.com", 
        password: "password", 
        name: "Admin User", 
        role: "admin", 
        joinDate: new Date().toISOString(), 
        subscription: "Admin", 
        lastLogin: new Date().toISOString() 
    }
];

// Movie data with owner information
let movies = JSON.parse(localStorage.getItem('amviewMovies')) || [];

// Pending owner accounts and movie uploads
let pendingOwners = JSON.parse(localStorage.getItem('pendingOwners')) || [];
let pendingMovies = JSON.parse(localStorage.getItem('pendingMovies')) || [];

// Current user
let currentUser = null;
let myList = JSON.parse(localStorage.getItem('myList')) || [];

// Phase 1: Enhanced features data
let watchProgress = JSON.parse(localStorage.getItem('watchProgress')) || {};
let reviews = JSON.parse(localStorage.getItem('movieReviews')) || {};

// Phase 2: Enhanced features data
let userPreferences = JSON.parse(localStorage.getItem('userPreferences')) || {
    favoriteGenres: [],
    watchedMovies: [],
    likedMovies: [],
    dislikedMovies: [],
    watchTime: 0,
    preferredLanguages: ['English'],
    maturityLevel: 'all'
};

let offlineDownloads = JSON.parse(localStorage.getItem('offlineDownloads')) || {};
let familyMembers = JSON.parse(localStorage.getItem('familyMembers')) || [];
let searchFilters = {
    genres: [],
    years: [],
    ratings: [],
    languages: [],
    durations: []
};

// Enhanced video data structure
let videoQualities = {
    1: {
        quality: '1080p',
        url: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
        bitrate: '4000kbps'
    },
    2: {
        quality: '720p', 
        url: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',
        bitrate: '2500kbps'
    },
    3: {
        quality: '480p',
        url: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',
        bitrate: '1500kbps'
    }
};

// ============================================
// DOM ELEMENTS
// ============================================

const loginPage = document.getElementById('login-page');
const userInterface = document.getElementById('user-interface');
const ownerInterface = document.getElementById('owner-interface');
const adminInterface = document.getElementById('admin-interface');
const loginModal = document.getElementById('login-modal');
const showLoginModalBtn = document.getElementById('show-login-modal');
const closeLoginModalBtn = document.getElementById('close-login-modal');
const loginForm = document.getElementById('login-form');
const signupForm = document.getElementById('signup-form');
const authTabs = document.querySelectorAll('.auth-tab');
const authForms = document.querySelectorAll('.auth-form');
const modalTitle = document.getElementById('modal-title');
const userTypeOptions = document.querySelectorAll('.user-type-option');
const paymentMethodSection = document.getElementById('payment-method-section');
const paymentOptions = document.querySelectorAll('.payment-option');
const mobileMoneyOptions = document.getElementById('mobile-money-options');
const bankOptions = document.getElementById('bank-options');
const mobileMoneyOptionItems = document.querySelectorAll('.mobile-money-option');
const bankOptionItems = document.querySelectorAll('.bank-option');
const notification = document.getElementById('notification');
const ownerNavLinks = document.querySelectorAll('.owner-nav-link');
const ownerPages = document.querySelectorAll('.owner-page');
const adminNavLinks = document.querySelectorAll('.admin-nav-link');
const adminPages = document.querySelectorAll('.admin-page');
const uploadMovieForm = document.getElementById('upload-movie-form');
const movieFileInput = document.getElementById('movie-file');
const movieFileName = document.getElementById('movie-file-name');
const videoPlayerOverlay = document.getElementById('video-player-overlay');
const videoPlayer = document.getElementById('video-player');
const closeVideoBtn = document.getElementById('close-video');
const videoTitle = document.getElementById('video-title');

// ============================================
// INITIALIZATION
// ============================================

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
    // Initialize movie data
    initializeMovieData();
    
    // Load movies from localStorage first
    loadMoviesFromStorage();
    
    // Update movie new status based on time
    updateMovieNewStatus();
    
      // Add event listener for Start Now button on login page
    const startNowBtn = document.querySelector('.btn-get-started');
    if (startNowBtn) {
        startNowBtn.addEventListener('click', function(e) {
            e.preventDefault();
            // Open the login modal (same as Sign In button)
            loginModal.classList.add('active');
            // Reset to login form when opening modal
            authTabs.forEach(t => t.classList.remove('active'));
            authTabs[0].classList.add('active');
            authForms.forEach(form => form.classList.remove('active'));
            authForms[0].classList.add('active');
            modalTitle.textContent = 'Sign In';
        });
    }
    
    // Also add to the second "Start Now" button in the CTA section
    const startNowBtn2 = document.querySelector('.cta-section .btn-get-started');
    if (startNowBtn2) {
        startNowBtn2.addEventListener('click', function(e) {
            e.preventDefault();
            loginModal.classList.add('active');
            authTabs.forEach(t => t.classList.remove('active'));
            authTabs[0].classList.add('active');
            authForms.forEach(form => form.classList.remove('active'));
            authForms[0].classList.add('active');
            modalTitle.textContent = 'Sign In';
        });
    }
    // Check if user is already logged in
    const savedUser = localStorage.getItem('currentUser');
    if (savedUser) {
        try {
            currentUser = JSON.parse(savedUser);
            showAppropriateInterface();
        } catch (error) {
            console.error('Error parsing saved user:', error);
            localStorage.removeItem('currentUser');
        }
    }

    // Load trending movies on login page
    loadTrendingMoviesOnLogin();

    // Initialize mobile menu
    initMobileMenu();

    // Initialize search functionality
    initSearch();

    // Initialize video player
    initVideoPlayer();

    // Initialize features section
    initFeaturesSection();

    // Initialize navigation
    initNavigation();

    // Auth tab switching
    authTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const formType = this.dataset.form;
            
            // Update active tab
            authTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            // Update modal title
            modalTitle.textContent = formType === 'login' ? 'Sign In' : 'Sign Up';
            
            // Show selected form
            authForms.forEach(form => form.classList.remove('active'));
            document.getElementById(`${formType}-form`).classList.add('active');
        });
    });

    // User type selection
    userTypeOptions.forEach(option => {
        option.addEventListener('click', function() {
            userTypeOptions.forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');
            
            const userType = this.dataset.type;
            
            // Show payment method section for movie owners
            if (userType === 'owner') {
                paymentMethodSection.style.display = 'block';
            } else {
                paymentMethodSection.style.display = 'none';
                // Reset payment selections
                paymentOptions.forEach(opt => opt.classList.remove('selected'));
                mobileMoneyOptions.style.display = 'none';
                bankOptions.style.display = 'none';
            }
        });
    });

    // Payment method selection
    paymentOptions.forEach(option => {
        option.addEventListener('click', function() {
            paymentOptions.forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');
            
            const method = this.dataset.method;
            
            // Show appropriate options
            if (method === 'mobile') {
                mobileMoneyOptions.style.display = 'block';
                bankOptions.style.display = 'none';
            } else if (method === 'bank') {
                mobileMoneyOptions.style.display = 'none';
                bankOptions.style.display = 'block';
            }
        });
    });

    // Mobile money provider selection
    mobileMoneyOptionItems.forEach(option => {
        option.addEventListener('click', function() {
            mobileMoneyOptionItems.forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');
        });
    });

    // Bank selection
    bankOptionItems.forEach(option => {
        option.addEventListener('click', function() {
            bankOptionItems.forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');
        });
    });

    // Login modal functionality
    if (showLoginModalBtn) {
        showLoginModalBtn.addEventListener('click', function() {
            loginModal.classList.add('active');
            // Reset to login form when opening modal
            authTabs.forEach(t => t.classList.remove('active'));
            authTabs[0].classList.add('active');
            authForms.forEach(form => form.classList.remove('active'));
            authForms[0].classList.add('active');
            modalTitle.textContent = 'Sign In';
        });
    }

    if (closeLoginModalBtn) {
        closeLoginModalBtn.addEventListener('click', function() {
            loginModal.classList.remove('active');
        });
    }

    // Close modal when clicking outside
    if (loginModal) {
        loginModal.addEventListener('click', function(e) {
            if (e.target === loginModal) {
                loginModal.classList.remove('active');
            }
        });
    }

    // Login form submission
    if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (email && password) {
                authenticateUser(email, password);
            } else {
                showNotification('Please enter both email and password.', 'error');
            }
        });
    }

    // Signup form submission
    if (signupForm) {
        signupForm.addEventListener('submit', function(e) {
            e.preventDefault();
            registerUser();
        });
    }

    // Owner navigation
    ownerNavLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const pageId = 'owner-' + this.dataset.page;
            
            // Update active nav link
            ownerNavLinks.forEach(l => l.classList.remove('active'));
            this.classList.add('active');
            
            // Show selected page
            ownerPages.forEach(page => page.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
            
            // Load appropriate content
            if (pageId === 'owner-dashboard') {
                loadOwnerDashboard();
            } else if (pageId === 'owner-status') {
                loadOwnerStatus();
            } else if (pageId === 'owner-movies') {
                loadOwnerMovies();
            }
        });
    });

    // Admin navigation
    adminNavLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const pageId = 'admin-' + this.dataset.page;
            
            // Update active nav link
            adminNavLinks.forEach(l => l.classList.remove('active'));
            this.classList.add('active');
            
            // Show selected page
            adminPages.forEach(page => page.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
            
            // Load appropriate content
            if (pageId === 'admin-owner-approvals') {
                loadOwnerApprovals();
            } else if (pageId === 'admin-movie-approvals') {
                loadMovieApprovals();
            }
        });
    });

    // Movie file upload handler
    if (movieFileInput) {
        movieFileInput.addEventListener('change', function() {
            if (this.files.length > 0 && movieFileName) {
                movieFileName.textContent = this.files[0].name;
            } else if (movieFileName) {
                movieFileName.textContent = 'No file chosen';
            }
        });
    }

    // Upload movie form submission
    if (uploadMovieForm) {
        uploadMovieForm.addEventListener('submit', function(e) {
            e.preventDefault();
            uploadMovie();
        });
    }

    // Video player close button
    if (closeVideoBtn) {
        closeVideoBtn.addEventListener('click', function() {
            closeVideoPlayer();
        });
    }

    // Close video player when clicking outside
    if (videoPlayerOverlay) {
        videoPlayerOverlay.addEventListener('click', function(e) {
            if (e.target === videoPlayerOverlay) {
                closeVideoPlayer();
            }
        });
    }

    // Logout functionality
    document.addEventListener('click', function(e) {
        if (e.target.classList.contains('logout-btn') || 
            e.target.classList.contains('admin-logout-btn') ||
            (e.target.closest && e.target.closest('#owner-logout-icon')) ||
            (e.target.closest && e.target.closest('#admin-logout-icon'))) {
            e.preventDefault();
            logout();
        }
    });

    // Real-time password validation
    const signupPassword = document.getElementById('signup-password');
    const confirmPassword = document.getElementById('confirm-password');
    
    if (signupPassword) {
        signupPassword.addEventListener('input', validatePasswordStrength);
    }
    
    if (confirmPassword) {
        confirmPassword.addEventListener('input', validatePasswordMatch);
    }

    // Phase 2: Initialize enhanced features
    initPhase2Features();

    // Load initial content if user is logged in
    if (currentUser) {
        if (currentUser.role === 'user') {
            loadHomePage();
        } else if (currentUser.role === 'owner') {
            loadOwnerDashboard();
        } else {
            loadOwnerApprovals();
            loadMovieApprovals();
        }
    }
});

// ============================================
// PHASE 2: CORE FEATURES IMPLEMENTATION
// ============================================

function initPhase2Features() {
    console.log('Initializing Phase 2 features...');
    
    // Initialize recommendation engine
    initRecommendationEngine();
    
    // Initialize offline downloads
    initOfflineDownloads();
    
    // Initialize family accounts
    initFamilyAccounts();
    
    // Initialize advanced search
    initAdvancedSearch();
    
    // Update UI with new features
    updateUIWithPhase2Features();
}

// ============================================
// 5. RECOMMENDATION ENGINE
// ============================================

function initRecommendationEngine() {
    // Track user behavior for recommendations
    trackUserBehavior();
    
    // Generate initial recommendations
    generateRecommendations();
}

function trackUserBehavior() {
    // Track movie views
    document.addEventListener('click', function(e) {
        if (e.target.closest('.movie-card') || e.target.closest('.trending-card')) {
            const movieCard = e.target.closest('.movie-card') || e.target.closest('.trending-card');
            const movieId = parseInt(movieCard.dataset.movieId);
            
            if (movieId && !userPreferences.watchedMovies.includes(movieId)) {
                userPreferences.watchedMovies.push(movieId);
                
                // Track genre preference
                const movie = movies.find(m => m.id === movieId);
                if (movie && movie.genre) {
                    if (!userPreferences.favoriteGenres.includes(movie.genre)) {
                        userPreferences.favoriteGenres.push(movie.genre);
                    }
                }
                
                saveUserPreferences();
            }
        }
    });
}

function generateRecommendations() {
    const recommendedMovies = getPersonalizedRecommendations();
    const container = document.getElementById('recommended-movies');
    
    if (!container) return;
    
    if (recommendedMovies.length === 0) {
        container.innerHTML = `
            <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                <h3>No recommendations yet</h3>
                <p>Watch a few movies to get personalized recommendations!</p>
                <a href="#" class="btn-primary" data-page="browse">Browse Movies</a>
            </div>
        `;
        return;
    }
    
    renderMovieGrid('recommended-movies', recommendedMovies);
    
    // Show recommendation explanation
    showRecommendationExplanation(recommendedMovies);
}

function getPersonalizedRecommendations() {
    if (userPreferences.watchedMovies.length === 0) {
        // If no watch history, show trending movies
        return movies.filter(m => m.trending).slice(0, 6);
    }
    
    // Get favorite genres
    const favoriteGenres = userPreferences.favoriteGenres;
    
    // Filter movies by favorite genres, excluding watched movies
    let recommendations = movies.filter(movie => {
        return !userPreferences.watchedMovies.includes(movie.id) &&
               favoriteGenres.some(genre => 
                   movie.genre.toLowerCase().includes(genre.toLowerCase())
               );
    });
    
    // If not enough recommendations, add popular movies
    if (recommendations.length < 6) {
        const popularMovies = movies
            .filter(m => !userPreferences.watchedMovies.includes(m.id) && m.rating > 7)
            .sort((a, b) => b.rating - a.rating);
        
        recommendations = [...recommendations, ...popularMovies];
    }
    
    // Remove duplicates and limit to 6 movies
    recommendations = Array.from(new Set(recommendations.map(m => m.id)))
        .map(id => recommendations.find(m => m.id === id))
        .slice(0, 6);
    
    return recommendations;
}

function showRecommendationExplanation(recommendedMovies) {
    const explanationDiv = document.querySelector('.recommendation-explanation');
    const reasonText = document.getElementById('recommendation-reason');
    
    if (!explanationDiv || !reasonText) return;
    
    if (userPreferences.watchedMovies.length === 0) {
        reasonText.textContent = "Based on popular movies trending right now.";
    } else {
        const genres = userPreferences.favoriteGenres.slice(0, 3).join(', ');
        reasonText.textContent = `Based on your interest in ${genres} movies.`;
    }
    
    explanationDiv.style.display = 'block';
}

function saveUserPreferences() {
    localStorage.setItem('userPreferences', JSON.stringify(userPreferences));
}

// ============================================
// 6. OFFLINE DOWNLOADS
// ============================================

function initOfflineDownloads() {
    // Add download buttons to movie cards
    addDownloadButtons();
    
    // Initialize download functionality
    initDownloadFunctionality();
}

function addDownloadButtons() {
    // This function will be called when rendering movie grids
    enhanceMovieCardsWithDownloads();
}

function enhanceMovieCardsWithDownloads() {
    // Override or extend the existing renderMovieGrid function
    const originalRenderMovieGrid = window.renderMovieGrid;
    
    window.renderMovieGrid = function(containerId, movies, showRemoveButton = false) {
        const container = document.getElementById(containerId);
        if (!container) return;
        
        container.innerHTML = '';
        
        if (movies.length === 0) {
            container.innerHTML = '<p>No movies found.</p>';
            return;
        }
        
        movies.forEach(movie => {
            const movieCard = document.createElement('div');
            movieCard.className = 'movie-card';
            movieCard.setAttribute('data-movie-id', movie.id);
            
            // Check if movie is recently added
            const isRecentlyAdded = movie.addedDate && 
                (new Date() - new Date(movie.addedDate)) < (30 * 24 * 60 * 60 * 1000);
            
            // Check if movie is downloaded
            const isDownloaded = offlineDownloads[movie.id];
            
            movieCard.innerHTML = `
                <div class="movie-card-inner">
                    ${isRecentlyAdded ? '<div class="new-badge">NEW</div>' : ''}
                    ${isDownloaded ? '<div class="downloaded-badge"><i class="fas fa-check-circle"></i> Downloaded</div>' : ''}
                    <img src="${movie.poster}" alt="${movie.title}" class="movie-poster">
                    <div class="movie-info">
                        <h3 class="movie-title">${movie.title}</h3>
                        <div class="movie-meta">
                            <span>${movie.year}</span>
                            <span class="movie-rating"><i class="fas fa-star"></i> ${movie.rating}</span>
                        </div>
                        <div class="movie-actions">
                            ${!isDownloaded ? 
                                `<button class="btn-secondary download-movie-btn" data-movie-id="${movie.id}">
                                    <i class="fas fa-download"></i> Download
                                </button>` :
                                `<button class="btn-secondary remove-download-btn" data-movie-id="${movie.id}">
                                    <i class="fas fa-trash"></i> Remove
                                </button>`
                            }
                            ${showRemoveButton ? 
                                `<button class="btn-secondary remove-from-list" data-movie-id="${movie.id}">Remove</button>` : 
                                ''
                            }
                        </div>
                    </div>
                </div>
            `;
            
            // Add click event to show movie details
            movieCard.addEventListener('click', function(e) {
                if (!e.target.classList.contains('download-movie-btn') && 
                    !e.target.classList.contains('remove-download-btn') &&
                    !e.target.classList.contains('remove-from-list') &&
                    !e.target.closest('.download-movie-btn') &&
                    !e.target.closest('.remove-download-btn') &&
                    !e.target.closest('.remove-from-list')) {
                    showMovieDetails(movie.id);
                }
            });
            
            container.appendChild(movieCard);
        });
        
        // Add event listeners for download buttons
        container.querySelectorAll('.download-movie-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const movieId = parseInt(this.dataset.movieId);
                downloadMovie(movieId);
            });
        });
        
        // Add event listeners for remove download buttons
        container.querySelectorAll('.remove-download-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const movieId = parseInt(this.dataset.movieId);
                removeDownload(movieId);
            });
        });
        
        // Add event listeners for remove from list buttons if present
        if (showRemoveButton) {
            container.querySelectorAll('.remove-from-list').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const movieId = parseInt(this.dataset.movieId);
                    removeFromList(movieId);
                });
            });
        }
    };
}

function downloadMovie(movieId) {
    const movie = movies.find(m => m.id === movieId);
    if (!movie) {
        showNotification('Movie not found!', 'error');
        return;
    }
    
    // Check storage quota
    if (!checkStorageQuota()) {
        showNotification('Storage limit reached. Please free up space.', 'error');
        return;
    }
    
    // Simulate download process
    showNotification(`Downloading "${movie.title}"...`, 'success');
    
    // Create download object
    offlineDownloads[movieId] = {
        movieId: movieId,
        title: movie.title,
        downloadedAt: new Date().toISOString(),
        size: '1.2 GB', // Simulated size
        progress: 0,
        status: 'downloading'
    };
    
    localStorage.setItem('offlineDownloads', JSON.stringify(offlineDownloads));
    
    // Update storage status
    updateStorageStatus();
    
    // Simulate download progress
    simulateDownloadProgress(movieId);
}

function simulateDownloadProgress(movieId) {
    let progress = 0;
    const interval = setInterval(() => {
        progress += 10;
        offlineDownloads[movieId].progress = progress;
        
        // Update UI if on downloads page
        updateDownloadProgressUI(movieId, progress);
        
        if (progress >= 100) {
            clearInterval(interval);
            offlineDownloads[movieId].status = 'downloaded';
            offlineDownloads[movieId].progress = 100;
            localStorage.setItem('offlineDownloads', JSON.stringify(offlineDownloads));
            
            showNotification('Download complete! Movie is now available offline.', 'success');
            
            // Refresh movie grids to show downloaded badge
            refreshMovieGrids();
            
            // Update downloads page
            if (document.getElementById('downloads-page') && 
                !document.getElementById('downloads-page').classList.contains('hidden')) {
                loadDownloadsPage();
            }
        }
    }, 300);
}

function removeDownload(movieId) {
    if (offlineDownloads[movieId]) {
        delete offlineDownloads[movieId];
        localStorage.setItem('offlineDownloads', JSON.stringify(offlineDownloads));
        
        // Update storage status
        updateStorageStatus();
        
        showNotification('Download removed. Storage freed.', 'success');
        
        // Refresh movie grids to remove downloaded badge
        refreshMovieGrids();
        
        // Update downloads page
        if (document.getElementById('downloads-page') && 
            !document.getElementById('downloads-page').classList.contains('hidden')) {
            loadDownloadsPage();
        }
    }
}

function checkStorageQuota() {
    const downloadedCount = Object.keys(offlineDownloads).length;
    return downloadedCount < 10; // Limit to 10 downloads
}

function updateStorageStatus() {
    const downloadedCount = Object.keys(offlineDownloads).length;
    const storageFill = document.querySelector('.storage-fill');
    const storageStatus = document.getElementById('storage-status');
    
    if (storageFill) {
        storageFill.style.width = `${(downloadedCount / 10) * 100}%`;
    }
    
    if (storageStatus) {
        storageStatus.textContent = `${downloadedCount} of 10 downloads used`;
    }
}

function loadDownloadsPage() {
    const downloadsGrid = document.getElementById('downloads-grid');
    const noDownloadsDiv = document.querySelector('.no-downloads');
    
    if (!downloadsGrid) return;
    
    downloadsGrid.innerHTML = '';
    
    const downloadedMovies = Object.values(offlineDownloads)
        .map(download => movies.find(m => m.id === download.movieId))
        .filter(movie => movie);
    
    if (downloadedMovies.length === 0) {
        if (noDownloadsDiv) noDownloadsDiv.style.display = 'block';
        return;
    }
    
    if (noDownloadsDiv) noDownloadsDiv.style.display = 'none';
    
    // Use existing movie grid rendering but with special download cards
    downloadedMovies.forEach(download => {
        const movie = movies.find(m => m.id === download.movieId);
        if (!movie) return;
        
        const downloadCard = document.createElement('div');
        downloadCard.className = 'download-card';
        downloadCard.innerHTML = `
            <div style="display: flex; gap: 20px; padding: 20px; background: var(--glass); border-radius: 12px;">
                <img src="${movie.poster}" alt="${movie.title}" style="width: 100px; height: 150px; object-fit: cover; border-radius: 8px;">
                <div style="flex: 1;">
                    <h3 style="margin-bottom: 10px;">${movie.title}</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 10px;">${movie.year} • ${movie.genre}</p>
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn-primary watch-offline-btn" data-movie-id="${movie.id}">
                            <i class="fas fa-play"></i> Watch Offline
                        </button>
                        <button class="btn-secondary remove-download-btn" data-movie-id="${movie.id}">
                            <i class="fas fa-trash"></i> Remove
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        downloadsGrid.appendChild(downloadCard);
    });
    
    // Add event listeners
    downloadsGrid.querySelectorAll('.watch-offline-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const movieId = parseInt(this.dataset.movieId);
            watchOffline(movieId);
        });
    });
    
    downloadsGrid.querySelectorAll('.remove-download-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const movieId = parseInt(this.dataset.movieId);
            removeDownload(movieId);
        });
    });
    
    // Update storage status
    updateStorageStatus();
}

function watchOffline(movieId) {
    const movie = movies.find(m => m.id === movieId);
    if (!movie) return;
    
    showNotification(`Playing "${movie.title}" from offline storage`, 'success');
    playVideo(movie.videoUrl, movie.title);
}

function refreshMovieGrids() {
    // Refresh all visible movie grids
    const gridContainers = ['trending-movies', 'new-releases', 'browse-movies', 'my-list-movies', 'recommended-movies'];
    
    gridContainers.forEach(containerId => {
        const container = document.getElementById(containerId);
        if (container && container.innerHTML !== '') {
            // Re-render the grid
            if (containerId === 'trending-movies') {
                const trendingMovies = movies.filter(movie => movie.trending);
                window.renderMovieGrid('trending-movies', trendingMovies);
            } else if (containerId === 'new-releases') {
                const newReleases = movies.filter(movie => movie.new);
                window.renderMovieGrid('new-releases', newReleases);
            } else if (containerId === 'recommended-movies') {
                generateRecommendations();
            }
        }
    });
}

// ============================================
// 7. FAMILY ACCOUNTS
// ============================================

function initFamilyAccounts() {
    // Initialize family account functionality
    initFamilyFunctionality();
}

function initFamilyFunctionality() {
    // Add event listener for adding family members
    const addFamilyMemberBtn = document.getElementById('add-family-member-btn');
    if (addFamilyMemberBtn) {
        addFamilyMemberBtn.addEventListener('click', addFamilyMember);
    }
    
    // Load existing family members
    refreshFamilyMembersList();
}

function addFamilyMember() {
    const name = document.getElementById('family-member-name').value.trim();
    const email = document.getElementById('family-member-email').value.trim();
    const relationship = document.getElementById('family-member-relationship').value;
    
    if (!name || !email) {
        showNotification('Please enter both name and email', 'error');
        return;
    }
    
    // Validate email
    if (!isValidEmail(email)) {
        showNotification('Please enter a valid email address', 'error');
        return;
    }
    
    // Check if already added
    if (familyMembers.some(member => member.email === email)) {
        showNotification('This family member is already added', 'error');
        return;
    }
    
    // Check limit (max 5 family members)
    if (familyMembers.length >= 5) {
        showNotification('Maximum 5 family members allowed', 'error');
        return;
    }
    
    const newMember = {
        name,
        email,
        relationship,
        addedDate: new Date().toISOString(),
        canWatch: true,
        kidSafeMode: relationship === 'child'
    };
    
    familyMembers.push(newMember);
    localStorage.setItem('familyMembers', JSON.stringify(familyMembers));
    
    showNotification(`${name} added as family member`, 'success');
    
    // Refresh family members list
    refreshFamilyMembersList();
    
    // Clear form
    document.getElementById('family-member-name').value = '';
    document.getElementById('family-member-email').value = '';
}

function removeFamilyMember(email) {
    familyMembers = familyMembers.filter(member => member.email !== email);
    localStorage.setItem('familyMembers', JSON.stringify(familyMembers));
    
    showNotification('Family member removed', 'success');
    refreshFamilyMembersList();
}

function refreshFamilyMembersList() {
    const familyList = document.getElementById('family-members-list');
    if (!familyList) return;
    
    familyList.innerHTML = familyMembers.length === 0 ? 
        '<p>No family members added yet.</p>' : 
        familyMembers.map(member => `
            <div class="family-member">
                <div>
                    <strong>${member.name}</strong>
                    <p style="color: var(--text-secondary); margin-top: 5px;">${member.email} (${member.relationship})</p>
                </div>
                <button class="btn-secondary remove-family-member-btn" data-email="${member.email}">
                    <i class="fas fa-times"></i> Remove
                </button>
            </div>
        `).join('');
    
    // Re-add event listeners
    familyList.querySelectorAll('.remove-family-member-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            removeFamilyMember(this.dataset.email);
        });
    });
}

// ============================================
// 8. ADVANCED SEARCH FILTERS
// ============================================

function initAdvancedSearch() {
    // Enhance existing search with advanced filters
    enhanceSearchWithFilters();
    
    // Add advanced search modal event listeners
    addAdvancedSearchEventListeners();
}

function enhanceSearchWithFilters() {
    // Add filter button to search container
    const searchContainer = document.querySelector('.search-container');
    if (!searchContainer) return;
    
    const filterButton = document.createElement('button');
    filterButton.className = 'search-filter-btn';
    filterButton.innerHTML = '<i class="fas fa-filter"></i>';
    filterButton.title = 'Advanced Filters';
    filterButton.style.marginLeft = '10px';
    
    filterButton.addEventListener('click', function() {
        showAdvancedSearchFilters();
    });
    
    searchContainer.appendChild(filterButton);
}

function addAdvancedSearchEventListeners() {
    const advancedSearchModal = document.getElementById('advanced-search-modal');
    if (!advancedSearchModal) return;
    
    // Close modal
    advancedSearchModal.querySelector('.close-modal').addEventListener('click', function() {
        advancedSearchModal.classList.remove('active');
    });
    
    // Apply filters
    advancedSearchModal.querySelector('#apply-filters').addEventListener('click', function() {
        applyAdvancedFilters();
        advancedSearchModal.classList.remove('active');
    });
    
    // Clear filters
    advancedSearchModal.querySelector('#clear-filters').addEventListener('click', function() {
        clearAdvancedFilters();
        advancedSearchModal.classList.remove('active');
    });
    
    // Close modal when clicking outside
    advancedSearchModal.addEventListener('click', function(e) {
        if (e.target === advancedSearchModal) {
            advancedSearchModal.classList.remove('active');
        }
    });
}

function showAdvancedSearchFilters() {
    const modal = document.getElementById('advanced-search-modal');
    if (modal) {
        modal.classList.add('active');
    }
}

function applyAdvancedFilters() {
    // Get selected filters
    const selectedGenres = Array.from(document.querySelectorAll('.genre-filter:checked'))
        .map(cb => cb.value);
    
    const yearFrom = document.getElementById('year-from').value;
    const yearTo = document.getElementById('year-to').value;
    const minRating = document.getElementById('min-rating').value;
    const maxDuration = document.getElementById('max-duration').value;
    
    // Store filters for search
    searchFilters.genres = selectedGenres;
    searchFilters.yearFrom = yearFrom;
    searchFilters.yearTo = yearTo;
    searchFilters.minRating = minRating;
    searchFilters.maxDuration = maxDuration;
    
    // Apply filters to current search
    performFilteredSearch();
}

function clearAdvancedFilters() {
    // Clear all filter inputs
    document.querySelectorAll('.genre-filter:checked').forEach(cb => cb.checked = false);
    document.getElementById('year-from').value = '';
    document.getElementById('year-to').value = '';
    document.getElementById('min-rating').value = '0';
    document.getElementById('max-duration').value = '';
    
    // Clear stored filters
    searchFilters = {
        genres: [],
        yearFrom: '',
        yearTo: '',
        minRating: '0',
        maxDuration: ''
    };
    
    // Refresh search if active
    const searchInput = document.getElementById('search-input');
    if (searchInput && searchInput.value) {
        performFilteredSearch();
    }
}

function performFilteredSearch() {
    const searchInput = document.getElementById('search-input');
    const query = searchInput ? searchInput.value.toLowerCase().trim() : '';
    
    let filteredMovies = movies;
    
    // Apply text search
    if (query) {
        filteredMovies = filteredMovies.filter(movie => 
            movie.title.toLowerCase().includes(query) ||
            movie.genre.toLowerCase().includes(query) ||
            movie.description.toLowerCase().includes(query)
        );
    }
    
    // Apply genre filters
    if (searchFilters.genres.length > 0) {
        filteredMovies = filteredMovies.filter(movie =>
            searchFilters.genres.some(genre => 
                movie.genre.toLowerCase().includes(genre)
            )
        );
    }
    
    // Apply year range filter
    if (searchFilters.yearFrom) {
        filteredMovies = filteredMovies.filter(movie => 
            movie.year >= parseInt(searchFilters.yearFrom)
        );
    }
    
    if (searchFilters.yearTo) {
        filteredMovies = filteredMovies.filter(movie => 
            movie.year <= parseInt(searchFilters.yearTo)
        );
    }
    
    // Apply rating filter
    if (searchFilters.minRating && searchFilters.minRating !== '0') {
        filteredMovies = filteredMovies.filter(movie => 
            movie.rating >= parseFloat(searchFilters.minRating)
        );
    }
    
    // Apply duration filter
    if (searchFilters.maxDuration) {
        filteredMovies = filteredMovies.filter(movie => 
            movie.duration <= parseInt(searchFilters.maxDuration)
        );
    }
    
    // Display results
    const searchResults = document.getElementById('search-results');
    if (searchResults) {
        displaySearchResults(filteredMovies, searchResults);
    }
    
    // Also update browse page if active
    if (document.getElementById('browse-page') && 
        !document.getElementById('browse-page').classList.contains('hidden')) {
        renderMovieGrid('browse-movies', filteredMovies);
    }
}

// ============================================
// CORE FUNCTIONS (Existing from original code)
// ============================================

// Initialize movie data
function initializeMovieData() {
    if (movies.length === 0) {
        movies = [
            {
                id: 1,
                title: "The Last Adventure",
                year: 2023,
                rating: 8.5,
                genre: "Action",
                description: "A thrilling adventure about a group of explorers discovering ancient secrets.",
                poster: "https://images.unsplash.com/photo-1485846234645-a62644f84728?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2059&q=80",
                featured: true,
                trending: true,
                new: true,
                duration: 135,
                language: "English",
                downloadable: true,
                videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
                addedDate: new Date().toISOString(),
                owner: "owner@amview.com",
                status: "approved"
            },
            {
                id: 2,
                title: "Midnight in Paris",
                year: 2023,
                rating: 7.8,
                genre: "Romance",
                description: "A romantic story set in the beautiful streets of Paris.",
                poster: "https://images.unsplash.com/photo-1594909122845-11baa439b7bf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80",
                featured: false,
                trending: true,
                new: true,
                duration: 120,
                language: "English",
                downloadable: true,
                videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4",
                addedDate: new Date().toISOString(),
                owner: "owner@amview.com",
                status: "approved"
            },
            {
                id: 3,
                title: "Space Odyssey",
                year: 2023,
                rating: 9.1,
                genre: "Sci-Fi",
                description: "An epic journey through space and time exploring the mysteries of the universe.",
                poster: "https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2071&q=80",
                featured: true,
                trending: false,
                new: true,
                duration: 148,
                language: "English",
                downloadable: true,
                videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4",
                addedDate: new Date().toISOString(),
                owner: "owner@amview.com",
                status: "approved"
            }
        ];
        localStorage.setItem('amviewMovies', JSON.stringify(movies));
    }
}

// Initialize navigation
function initNavigation() {
    // Navigation between pages
    document.addEventListener('click', function(e) {
        const navLink = e.target.closest('.nav-link');
        if (navLink) {
            e.preventDefault();
            const targetPage = navLink.dataset.page;
            
            if (!targetPage) return;
            
            navigateToPage(targetPage);
        }
    });

    // Add to list button functionality
    document.addEventListener('click', function(e) {
        if (e.target.id === 'add-to-list-btn' || e.target.closest('#add-to-list-btn')) {
            e.preventDefault();
            const button = e.target.id === 'add-to-list-btn' ? e.target : e.target.closest('#add-to-list-btn');
            const movieId = parseInt(button.dataset.movieId);
            if (movieId) {
                toggleMovieInList(movieId);
            }
        }
    });

    // Watch now button functionality
    document.addEventListener('click', function(e) {
        if (e.target.id === 'watch-now-btn' || e.target.closest('#watch-now-btn')) {
            e.preventDefault();
            const button = e.target.id === 'watch-now-btn' ? e.target : e.target.closest('#watch-now-btn');
            const movieId = parseInt(button.dataset.movieId);
            if (movieId) {
                const movie = movies.find(m => m.id === movieId);
                if (movie && movie.videoUrl) {
                    playVideo(movie.videoUrl, movie.title);
                }
            }
        }
    });
}

// Add this new function for page navigation
function navigateToPage(pageName) {
    // Hide all pages
    document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
    
    // Show target page
    const targetPageElement = document.getElementById(pageName + '-page');
    if (targetPageElement) {
        targetPageElement.classList.remove('hidden');
    }
    
    // Update active nav link
    document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
    const activeLink = document.querySelector(`.nav-link[data-page="${pageName}"]`);
    if (activeLink) {
        activeLink.classList.add('active');
    }
    
    // Load appropriate content
    switch(pageName) {
        case 'home':
            loadHomePage();
            break;
        case 'browse':
            loadBrowsePage();
            break;
        case 'my-list':
            loadMyListPage();
            break;
        case 'downloads':
            loadDownloadsPage();
            break;
        case 'profile':
            // Profile page is already loaded with static content
            refreshFamilyMembersList();
            break;
        case 'movie-details':
            // Movie details page is handled separately
            break;
    }
}

// User Registration Function
function registerUser() {
    const name = document.getElementById('signup-name').value.trim();
    const email = document.getElementById('signup-email').value.trim().toLowerCase();
    const password = document.getElementById('signup-password').value;
    const confirmPassword = document.getElementById('confirm-password').value;
    const termsAgreed = document.getElementById('terms-agreement').checked;
    
    // Get selected user type
    const selectedUserType = document.querySelector('.user-type-option.selected');
    if (!selectedUserType) {
        showNotification('Please select a user type.', 'error');
        return;
    }
    const userType = selectedUserType.dataset.type;
    
    // Validation
    const errors = validateRegistration(name, email, password, confirmPassword, termsAgreed);
    
    if (errors.length > 0) {
        showNotification(errors.join(', '), 'error');
        return;
    }
    
    // Check if user already exists
    if (users.find(user => user.email === email)) {
        showNotification('An account with this email already exists.', 'error');
        return;
    }
    
    // Create new user object
    const newUser = {
        email: email,
        password: password,
        name: name,
        role: userType,
        joinDate: new Date().toISOString(),
        subscription: userType === 'owner' ? 'Owner' : 'Basic',
        lastLogin: new Date().toISOString()
    };
    
    // Add payment information for movie owners
    if (userType === 'owner') {
        const selectedPaymentMethod = document.querySelector('.payment-option.selected');
        if (!selectedPaymentMethod) {
            showNotification('Please select a payment method.', 'error');
            return;
        }
        
        newUser.paymentMethod = selectedPaymentMethod.dataset.method;
        
        if (newUser.paymentMethod === 'mobile') {
            const selectedProvider = document.querySelector('.mobile-money-option.selected');
            if (!selectedProvider) {
                showNotification('Please select a mobile money provider.', 'error');
                return;
            }
            newUser.paymentProvider = selectedProvider.dataset.provider;
            newUser.approved = false; // Requires admin approval
        } else if (newUser.paymentMethod === 'bank') {
            const selectedBank = document.querySelector('.bank-option.selected');
            if (!selectedBank) {
                showNotification('Please select a bank.', 'error');
                return;
            }
            newUser.paymentProvider = selectedBank.dataset.bank;
            newUser.approved = false; // Requires admin approval
        }
        
        // Add to pending owners for admin approval
        pendingOwners.push(newUser);
        localStorage.setItem('pendingOwners', JSON.stringify(pendingOwners));
        
        showNotification('Movie owner account created! Waiting for admin approval.', 'success');
    } else {
        // Regular user - no approval needed
        users.push(newUser);
        localStorage.setItem('amviewUsers', JSON.stringify(users));
        
        // Auto-login the new user
        currentUser = newUser;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        showNotification('Account created successfully! Welcome to AMVIEW!', 'success');
        
        // Close modal and show user interface
        setTimeout(() => {
            loginModal.classList.remove('active');
            showAppropriateInterface();
        }, 1500);
    }
    
    // Reset form
    signupForm.reset();
    userTypeOptions.forEach(opt => opt.classList.remove('selected'));
    paymentMethodSection.style.display = 'none';
}

// Registration Validation
function validateRegistration(name, email, password, confirmPassword, termsAgreed) {
    const errors = [];
    
    if (!name || name.length < 2) {
        errors.push('Please enter a valid full name (at least 2 characters)');
    }
    
    if (!email || !isValidEmail(email)) {
        errors.push('Please enter a valid email address');
    }
    
    if (!password || password.length < 6) {
        errors.push('Password must be at least 6 characters long');
    }
    
    if (password !== confirmPassword) {
        errors.push('Passwords do not match');
    }
    
    if (!termsAgreed) {
        errors.push('Please agree to the Terms of Service and Privacy Policy');
    }
    
    return errors;
}

// Email validation
function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}

// Password strength validation
function validatePasswordStrength() {
    const password = document.getElementById('signup-password').value;
    const strengthBar = document.querySelector('.strength-fill');
    const strengthText = document.getElementById('strength-text');
    
    if (!strengthBar || !strengthText) return;
    
    let strength = 'weak';
    let text = 'Weak';
    
    if (password.length >= 8) {
        strength = 'medium';
        text = 'Medium';
    }
    
    if (password.length >= 12 && /[A-Z]/.test(password) && /[0-9]/.test(password) && /[^A-Za-z0-9]/.test(password)) {
        strength = 'strong';
        text = 'Strong';
    }
    
    strengthBar.className = `strength-fill strength-${strength}`;
    strengthText.textContent = text;
    strengthText.style.color = strength === 'weak' ? '#ff6b6b' : strength === 'medium' ? '#ffe66d' : '#4ecdc4';
}

// Password match validation
function validatePasswordMatch() {
    const password = document.getElementById('signup-password').value;
    const confirmPassword = document.getElementById('confirm-password').value;
    const confirmGroup = document.getElementById('confirm-password').closest('.form-group');
    const errorElement = confirmGroup.querySelector('.error') || createErrorElement(confirmGroup);
    
    if (confirmPassword && password !== confirmPassword) {
        errorElement.textContent = 'Passwords do not match';
        errorElement.style.display = 'block';
        confirmGroup.classList.add('error');
    } else {
        errorElement.style.display = 'none';
        confirmGroup.classList.remove('error');
        if (password === confirmPassword && confirmPassword) {
            confirmGroup.classList.add('success');
        }
    }
}

// Create error element for form validation
function createErrorElement(formGroup) {
    const errorElement = document.createElement('div');
    errorElement.className = 'error';
    formGroup.appendChild(errorElement);
    return errorElement;
}

// Authentication function
function authenticateUser(email, password) {
    // Check regular users first
    let user = users.find(u => u.email === email && u.password === password);
    
    // If not found in regular users, check pending owners
    if (!user) {
        user = pendingOwners.find(u => u.email === email && u.password === password);
        if (user) {
            if (user.approved) {
                // Move from pending to regular users if approved
                users.push(user);
                pendingOwners = pendingOwners.filter(u => u.email !== email);
                localStorage.setItem('amviewUsers', JSON.stringify(users));
                localStorage.setItem('pendingOwners', JSON.stringify(pendingOwners));
            } else {
                showNotification('Your movie owner account is pending admin approval.', 'error');
                return false;
            }
        }
    }
    
    if (user) {
        // Update last login
        user.lastLogin = new Date().toISOString();
        localStorage.setItem('amviewUsers', JSON.stringify(users));
        
        currentUser = user;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        showAppropriateInterface();
        showNotification('Login successful!', 'success');
        return true;
    } else {
        showNotification('Invalid email or password. Please try again.', 'error');
        return false;
    }
}

// Show appropriate interface based on user role
function showAppropriateInterface() {
    if (!currentUser) return;
    
    loginModal.classList.remove('active');
    loginPage.classList.add('hidden');
    
    if (currentUser.role === 'user') {
        userInterface.classList.remove('hidden');
        ownerInterface.classList.add('hidden');
        adminInterface.classList.add('hidden');
        
        // Update user info
        document.getElementById('user-avatar').textContent = currentUser.name.charAt(0).toUpperCase();
        document.getElementById('user-fullname').textContent = currentUser.name;
        
        // Load user content
        loadHomePage();
        initPhase2Features();
    } else if (currentUser.role === 'owner') {
        userInterface.classList.add('hidden');
        ownerInterface.classList.remove('hidden');
        adminInterface.classList.add('hidden');
        
        // Update owner info
        document.getElementById('owner-fullname').textContent = currentUser.name;
        
        // Load owner dashboard
        loadOwnerDashboard();
    } else if (currentUser.role === 'admin') {
        userInterface.classList.add('hidden');
        ownerInterface.classList.add('hidden');
        adminInterface.classList.remove('hidden');
        
        // Load admin content
        loadOwnerApprovals();
        loadMovieApprovals();
    }
}

// Logout function
function logout() {
    currentUser = null;
    localStorage.removeItem('currentUser');
    userInterface.classList.add('hidden');
    ownerInterface.classList.add('hidden');
    adminInterface.classList.add('hidden');
    loginPage.classList.remove('hidden');
    
    // Reset login form
    if (loginForm) loginForm.reset();
    
    // Show notification
    showNotification('You have been logged out successfully.', 'success');
}

// Load trending movies on login page
function loadTrendingMoviesOnLogin() {
    const trendingMovies = movies.filter(movie => movie.trending);
    const container = document.getElementById('trending-login');
    if (!container) return;
    
    container.innerHTML = '';
    
    trendingMovies.forEach(movie => {
        const movieCard = document.createElement('div');
        movieCard.className = 'trending-card';
        movieCard.innerHTML = `
            <img src="${movie.poster}" alt="${movie.title}" class="trending-poster">
            <div class="trending-info">
                <h3 class="trending-title">${movie.title}</h3>
                <div class="trending-meta">
                    <span>${movie.year}</span>
                    <span class="trending-rating"><i class="fas fa-star"></i> ${movie.rating}</span>
                </div>
            </div>
        `;
        container.appendChild(movieCard);
    });
}

// Load home page content
function loadHomePage() {
    console.log('Loading home page...');
    
    // Load trending movies (always show trending, not filtered by category)
    const trendingMovies = movies.filter(movie => movie.trending);
    renderMovieGrid('trending-movies', trendingMovies);
    
    // Load new releases (always show new releases, not filtered by category)
    loadNewReleases();
    
    // Initialize categories (but don't show any movies until a category is clicked)
    initCategories();
    
    // Generate recommendations
    generateRecommendations();
    
    // Initialize the category section to show the instruction message
    const categoryMoviesGrid = document.getElementById('category-movies');
    const noCategorySelected = document.getElementById('no-category-selected');
    const categoryResultsInfo = document.getElementById('category-results-info');
    
    if (categoryMoviesGrid) {
        categoryMoviesGrid.innerHTML = '';
    }
    if (noCategorySelected) {
        noCategorySelected.style.display = 'block';
    }
    if (categoryResultsInfo) {
        categoryResultsInfo.innerHTML = '';
    }
}

// Add categories functionality
function initCategories() {
    const categories = document.querySelectorAll('.category');
    const categoryMoviesGrid = document.getElementById('category-movies');
    const noCategorySelected = document.getElementById('no-category-selected');
    
    // Initially hide the category movies grid and show the instruction message
    if (categoryMoviesGrid) {
        categoryMoviesGrid.innerHTML = '';
    }
    if (noCategorySelected) {
        noCategorySelected.style.display = 'block';
    }
    
    categories.forEach(category => {
        category.addEventListener('click', function() {
            // Remove active class from all categories
            categories.forEach(cat => cat.classList.remove('active'));
            // Add active class to clicked category
            this.classList.add('active');
            
            const categoryName = this.textContent.toLowerCase();
            filterMoviesByCategory(categoryName);
        });
    });
}

function filterMoviesByCategory(category) {
    // Remove active class from all categories
    const categories = document.querySelectorAll('.category');
    categories.forEach(cat => cat.classList.remove('active'));
    
    // Add active class to clicked category
    const clickedCategory = Array.from(categories).find(cat => 
        cat.textContent.toLowerCase() === category
    );
    if (clickedCategory) {
        clickedCategory.classList.add('active');
    }
    
    // Get the category results elements
    const categoryMoviesGrid = document.getElementById('category-movies');
    const noCategorySelected = document.getElementById('no-category-selected');
    const categoryResultsInfo = document.getElementById('category-results-info');
    
    if (!categoryMoviesGrid || !noCategorySelected) return;
    
    if (category === 'all') {
        // Show ALL movies when "All" is selected
        if (movies.length === 0) {
            categoryMoviesGrid.innerHTML = '';
            categoryMoviesGrid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                    <h3>No movies available</h3>
                    <p>Check back later for new movies</p>
                </div>
            `;
            noCategorySelected.style.display = 'none';
        } else {
            // Show all movies
            window.renderMovieGrid('category-movies', movies);
            noCategorySelected.style.display = 'none';
            
            // Update results info
            if (categoryResultsInfo) {
                categoryResultsInfo.innerHTML = `
                    <h3 style="color: var(--text); margin-bottom: 10px;">All Movies (${movies.length} total)</h3>
                    <p style="color: var(--text-secondary);">Showing all available movies</p>
                `;
            }
        }
    } else {
        // Filter movies by the selected category
        const filteredMovies = movies.filter(movie => {
            if (!movie.genre) return false;
            const movieGenre = movie.genre.toLowerCase();
            return movieGenre.includes(category) || 
                   (category === 'sci-fi' && movieGenre.includes('scifi')) ||
                   (category === 'sci-fi' && movieGenre.includes('science fiction'));
        });
        
        // Hide the "select category" message
        noCategorySelected.style.display = 'none';
        
        if (filteredMovies.length === 0) {
            // No movies found in this category
            categoryMoviesGrid.innerHTML = '';
            categoryMoviesGrid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                    <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.5;"></i>
                    <h3>No movies found in "${category}"</h3>
                    <p>Try selecting a different category</p>
                </div>
            `;
            
            if (categoryResultsInfo) {
                categoryResultsInfo.innerHTML = `
                    <h3 style="color: var(--text); margin-bottom: 10px;">${category.charAt(0).toUpperCase() + category.slice(1)} Movies</h3>
                    <p style="color: var(--text-secondary);">No movies found in this category</p>
                `;
            }
        } else {
            // Show filtered movies
            window.renderMovieGrid('category-movies', filteredMovies);
            
            // Update results info
            if (categoryResultsInfo) {
                categoryResultsInfo.innerHTML = `
                    <h3 style="color: var(--text); margin-bottom: 10px;">${category.charAt(0).toUpperCase() + category.slice(1)} Movies (${filteredMovies.length} found)</h3>
                    <p style="color: var(--text-secondary);">Browse movies in ${category} genre</p>
                `;
            }
        }
    }
}

// Enhanced function to load new releases
function loadNewReleases() {
    // Get movies marked as new, sorted by addition date (newest first)
    const newReleases = movies
        .filter(movie => movie.new)
        .sort((a, b) => {
            // Sort by addedDate if available, otherwise by ID (newer first)
            if (a.addedDate && b.addedDate) {
                return new Date(b.addedDate) - new Date(a.addedDate);
            }
            return b.id - a.id;
        });
    
    renderMovieGrid('new-releases', newReleases);
}

// Load browse page content
function loadBrowsePage() {
    renderMovieGrid('browse-movies', movies);
}

// Load my list page content
function loadMyListPage() {
    const myListMovies = movies.filter(movie => myList.includes(movie.id));
    renderMovieGrid('my-list-movies', myListMovies, true);
}

// Load owner dashboard
function loadOwnerDashboard() {
    const ownerMovies = movies.filter(movie => movie.owner === currentUser.email);
    const approvedMovies = ownerMovies.filter(movie => movie.status === 'approved');
    const pendingMovies = ownerMovies.filter(movie => movie.status === 'pending');
    const rejectedMovies = ownerMovies.filter(movie => movie.status === 'rejected');
    
    document.getElementById('owner-total-movies').textContent = ownerMovies.length;
    document.getElementById('owner-approved-movies').textContent = approvedMovies.length;
    document.getElementById('owner-pending-movies').textContent = pendingMovies.length;
    document.getElementById('owner-rejected-movies').textContent = rejectedMovies.length;
}

// Load owner status page
function loadOwnerStatus() {
    const statusList = document.getElementById('upload-status-list');
    if (!statusList) return;
    
    statusList.innerHTML = '';
    
    const ownerMovies = movies.filter(movie => movie.owner === currentUser.email);
    
    if (ownerMovies.length === 0) {
        statusList.innerHTML = '<p>No movies uploaded yet.</p>';
        return;
    }
    
    ownerMovies.forEach(movie => {
        const statusItem = document.createElement('div');
        statusItem.className = 'status-item';
        
        let statusClass = '';
        let statusText = '';
        
        switch(movie.status) {
            case 'pending':
                statusClass = 'status-pending';
                statusText = 'Pending Approval';
                break;
            case 'processing':
                statusClass = 'status-processing';
                statusText = 'Processing';
                break;
            case 'approved':
                statusClass = 'status-approved';
                statusText = 'Approved';
                break;
            case 'rejected':
                statusClass = 'status-rejected';
                statusText = 'Rejected';
                break;
        }
        
        statusItem.innerHTML = `
            <div>
                <h4>${movie.title}</h4>
                <p>Uploaded: ${new Date(movie.addedDate).toLocaleDateString()}</p>
            </div>
            <div class="status-badge ${statusClass}">${statusText}</div>
        `;
        
        statusList.appendChild(statusItem);
    });
}

// Load owner movies page
function loadOwnerMovies() {
    const moviesGrid = document.getElementById('owner-movies-grid');
    if (!moviesGrid) return;
    
    moviesGrid.innerHTML = '';
    
    const ownerMovies = movies.filter(movie => movie.owner === currentUser.email);
    
    if (ownerMovies.length === 0) {
        moviesGrid.innerHTML = '<p>No movies uploaded yet.</p>';
        return;
    }
    
    ownerMovies.forEach(movie => {
        const movieCard = document.createElement('div');
        movieCard.className = 'movie-card';
        
        movieCard.innerHTML = `
            <div class="movie-card-inner">
                <img src="${movie.poster}" alt="${movie.title}" class="movie-poster">
                <div class="movie-info">
                    <h3 class="movie-title">${movie.title}</h3>
                    <div class="movie-meta">
                        <span>${movie.year}</span>
                        <span class="movie-rating"><i class="fas fa-star"></i> ${movie.rating}</span>
                    </div>
                    <div class="movie-actions">
                        <button class="btn-primary preview-movie" data-movie-id="${movie.id}">Preview</button>
                    </div>
                </div>
            </div>
        `;
        
        // Add click event to preview movie
        const previewBtn = movieCard.querySelector('.preview-movie');
        previewBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            previewMovie(movie.id);
        });
        
        moviesGrid.appendChild(movieCard);
    });
}

// Upload movie function
function uploadMovie() {
    const title = document.getElementById('movie-title').value;
    const year = parseInt(document.getElementById('release-year').value);
    const genre = document.getElementById('genre').value;
    const language = document.getElementById('language').value;
    const description = document.getElementById('description').value;
    const duration = parseInt(document.getElementById('duration').value);
    const rating = parseFloat(document.getElementById('rating').value);
    const posterUrl = document.getElementById('poster-url').value;
    const movieFile = document.getElementById('movie-file').files[0];
    
    // Validate form data
    const errors = validateMovieForm({
        title, year, genre, language, description, duration, rating
    });
    
    if (errors.length > 0) {
        showNotification('Please fix the following errors: ' + errors.join(', '), 'error');
        return;
    }
    
    if (!movieFile) {
        showNotification('Please select a movie file to upload.', 'error');
        return;
    }
    
    // Create new movie object
    const newMovie = {
        id: movies.length > 0 ? Math.max(...movies.map(m => m.id)) + 1 : 1,
        title,
        year,
        rating,
        genre,
        language,
        description,
        duration,
        poster: posterUrl || 'https://images.unsplash.com/photo-1485846234645-a62644f84728?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2059&q=80',
        featured: false,
        trending: false,
        new: true,
        downloadable: true,
        videoUrl: URL.createObjectURL(movieFile), // Create a local URL for the uploaded file
        addedDate: new Date().toISOString(),
        owner: currentUser.email,
        status: 'pending' // Requires admin approval
    };
    
    // Add to pending movies for admin approval
    pendingMovies.push(newMovie);
    localStorage.setItem('pendingMovies', JSON.stringify(pendingMovies));
    
    // Reset form
    uploadMovieForm.reset();
    movieFileName.textContent = 'No file chosen';
    
    // Show success message
    showNotification('Movie uploaded successfully! Waiting for admin approval.', 'success');
    
    // Refresh owner dashboard
    loadOwnerDashboard();
}

// Validate movie form data
function validateMovieForm(formData) {
    const errors = [];
    
    if (!formData.title || formData.title.trim().length < 2) {
        errors.push('Title must be at least 2 characters long');
    }
    
    if (!formData.year || formData.year < 1900 || formData.year > new Date().getFullYear() + 2) {
        errors.push('Please enter a valid release year');
    }
    
    if (!formData.genre) {
        errors.push('Please select a genre');
    }
    
    if (!formData.description || formData.description.trim().length < 10) {
        errors.push('Description must be at least 10 characters long');
    }
    
    if (!formData.duration || formData.duration < 1) {
        errors.push('Please enter a valid duration');
    }
    
    if (!formData.rating || formData.rating < 0 || formData.rating > 10) {
        errors.push('Rating must be between 0 and 10');
    }
    
    return errors;
}

// Preview movie function
function previewMovie(movieId) {
    const movie = movies.find(m => m.id === movieId);
    if (!movie) return;
    
    if (videoPlayer && videoPlayerOverlay && videoTitle) {
        videoPlayer.src = movie.videoUrl;
        videoTitle.textContent = `Preview: ${movie.title}`;
        videoPlayerOverlay.classList.add('active');
        
        videoPlayer.play().catch(error => {
            console.error('Error playing video:', error);
            showNotification('Error playing video. Please try again.', 'error');
        });
    }
}

// Close video player
function closeVideoPlayer() {
    if (videoPlayer) {
        videoPlayer.pause();
        videoPlayer.currentTime = 0;
        videoPlayer.src = '';
    }
    if (videoPlayerOverlay) {
        videoPlayerOverlay.classList.remove('active');
    }
}

// Load owner approvals for admin
function loadOwnerApprovals() {
    const approvalList = document.getElementById('owner-approval-list');
    if (!approvalList) return;
    
    approvalList.innerHTML = '';
    
    if (pendingOwners.length === 0) {
        approvalList.innerHTML = '<p>No pending owner approvals.</p>';
        return;
    }
    
    pendingOwners.forEach(owner => {
        const approvalItem = document.createElement('div');
        approvalItem.className = 'approval-item';
        
        approvalItem.innerHTML = `
            <div>
                <h4>${owner.name}</h4>
                <p>Email: ${owner.email}</p>
                <p>Payment Method: ${owner.paymentMethod} - ${owner.paymentProvider}</p>
                <p>Joined: ${new Date(owner.joinDate).toLocaleDateString()}</p>
            </div>
            <div class="approval-actions">
                <button class="btn-primary approve-owner" data-email="${owner.email}">Approve</button>
                <button class="btn-secondary reject-owner" data-email="${owner.email}">Reject</button>
            </div>
        `;
        
        approvalList.appendChild(approvalItem);
    });
    
    // Add event listeners for approval buttons
    document.querySelectorAll('.approve-owner').forEach(button => {
        button.addEventListener('click', function() {
            approveOwner(this.dataset.email);
        });
    });
    
    document.querySelectorAll('.reject-owner').forEach(button => {
        button.addEventListener('click', function() {
            rejectOwner(this.dataset.email);
        });
    });
}

// Load movie approvals for admin
function loadMovieApprovals() {
    const approvalList = document.getElementById('movie-approval-list');
    if (!approvalList) return;
    
    approvalList.innerHTML = '';
    
    if (pendingMovies.length === 0) {
        approvalList.innerHTML = '<p>No pending movie approvals.</p>';
        return;
    }
    
    pendingMovies.forEach(movie => {
        const approvalItem = document.createElement('div');
        approvalItem.className = 'approval-item';
        
        approvalItem.innerHTML = `
            <div>
                <h4>${movie.title}</h4>
                <p>Genre: ${movie.genre} | Year: ${movie.year}</p>
                <p>Owner: ${movie.owner}</p>
                <p>Uploaded: ${new Date(movie.addedDate).toLocaleDateString()}</p>
            </div>
            <div class="approval-actions">
                <button class="btn-primary approve-movie" data-movie-id="${movie.id}">Approve</button>
                <button class="btn-secondary reject-movie" data-movie-id="${movie.id}">Reject</button>
                <button class="btn-secondary preview-movie-admin" data-movie-id="${movie.id}">Preview</button>
            </div>
        `;
        
        approvalList.appendChild(approvalItem);
    });
    
    // Add event listeners for approval buttons
    document.querySelectorAll('.approve-movie').forEach(button => {
        button.addEventListener('click', function() {
            approveMovie(parseInt(this.dataset.movieId));
        });
    });
    
    document.querySelectorAll('.reject-movie').forEach(button => {
        button.addEventListener('click', function() {
            rejectMovie(parseInt(this.dataset.movieId));
        });
    });
    
    document.querySelectorAll('.preview-movie-admin').forEach(button => {
        button.addEventListener('click', function() {
            const movie = pendingMovies.find(m => m.id === parseInt(this.dataset.movieId));
            if (movie) {
                previewMovie(movie.id);
            }
        });
    });
}

// Approve owner account
function approveOwner(email) {
    const ownerIndex = pendingOwners.findIndex(owner => owner.email === email);
    if (ownerIndex === -1) return;
    
    const owner = pendingOwners[ownerIndex];
    owner.approved = true;
    
    // Move from pending to regular users
    users.push(owner);
    pendingOwners.splice(ownerIndex, 1);
    
    // Update localStorage
    localStorage.setItem('amviewUsers', JSON.stringify(users));
    localStorage.setItem('pendingOwners', JSON.stringify(pendingOwners));
    
    showNotification('Owner account approved successfully!', 'success');
    loadOwnerApprovals();
}

// Reject owner account
function rejectOwner(email) {
    const ownerIndex = pendingOwners.findIndex(owner => owner.email === email);
    if (ownerIndex === -1) return;
    
    pendingOwners.splice(ownerIndex, 1);
    
    // Update localStorage
    localStorage.setItem('pendingOwners', JSON.stringify(pendingOwners));
    
    showNotification('Owner account rejected.', 'success');
    loadOwnerApprovals();
}

// Approve movie
function approveMovie(movieId) {
    const movieIndex = pendingMovies.findIndex(movie => movie.id === movieId);
    if (movieIndex === -1) return;
    
    const movie = pendingMovies[movieIndex];
    movie.status = 'approved';
    
    // Move from pending to regular movies
    movies.push(movie);
    pendingMovies.splice(movieIndex, 1);
    
    // Update localStorage
    localStorage.setItem('amviewMovies', JSON.stringify(movies));
    localStorage.setItem('pendingMovies', JSON.stringify(pendingMovies));
    
    showNotification('Movie approved successfully!', 'success');
    loadMovieApprovals();
}

// Reject movie
function rejectMovie(movieId) {
    const movieIndex = pendingMovies.findIndex(movie => movie.id === movieId);
    if (movieIndex === -1) return;
    
    const movie = pendingMovies[movieIndex];
    movie.status = 'rejected';
    
    // Move from pending to regular movies but mark as rejected
    movies.push(movie);
    pendingMovies.splice(movieIndex, 1);
    
    // Update localStorage
    localStorage.setItem('amviewMovies', JSON.stringify(movies));
    localStorage.setItem('pendingMovies', JSON.stringify(pendingMovies));
    
    showNotification('Movie rejected.', 'success');
    loadMovieApprovals();
}

// Show notification
function showNotification(message, type = 'success') {
    if (!notification) return;
    
    notification.textContent = message;
    notification.className = `notification ${type}`;
    notification.classList.add('show');
    
    setTimeout(() => {
        notification.classList.remove('show');
    }, 3000);
}

// Initialize mobile menu
function initMobileMenu() {
    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
    const nav = document.querySelector('nav ul');
    
    if (mobileMenuBtn && nav) {
        mobileMenuBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            const isActive = nav.classList.contains('active');
            
            if (!isActive) {
                createMobileNavStructure(nav);
            } else {
                const mobileSearch = nav.querySelector('.mobile-search');
                const mobileUserMenu = nav.querySelector('.mobile-user-menu');
                if (mobileSearch) mobileSearch.remove();
                if (mobileUserMenu) mobileUserMenu.remove();
            }
            
            nav.classList.toggle('active');
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('nav') && !e.target.closest('.mobile-menu-btn')) {
                nav.classList.remove('active');
                const mobileSearch = nav.querySelector('.mobile-search');
                const mobileUserMenu = nav.querySelector('.mobile-user-menu');
                if (mobileSearch) mobileSearch.remove();
                if (mobileUserMenu) mobileUserMenu.remove();
            }
        });

        // Close mobile menu when clicking on navigation links
        nav.addEventListener('click', function(e) {
            if (e.target.classList.contains('nav-link') || e.target.closest('.nav-link')) {
                nav.classList.remove('active');
                const mobileSearch = nav.querySelector('.mobile-search');
                const mobileUserMenu = nav.querySelector('.mobile-user-menu');
                if (mobileSearch) mobileSearch.remove();
                if (mobileUserMenu) mobileUserMenu.remove();
            }
        });
    }
}

// Create mobile navigation structure
function createMobileNavStructure(nav) {
    // Clear existing mobile elements first
    const existingMobileSearch = nav.querySelector('.mobile-search');
    const existingMobileUser = nav.querySelector('.mobile-user-menu');
    if (existingMobileSearch) existingMobileSearch.remove();
    if (existingMobileUser) existingMobileUser.remove();
    
    // Create search container for mobile
    const mobileSearch = document.createElement('div');
    mobileSearch.className = 'search-container mobile-search';
    mobileSearch.innerHTML = `
        <input type="text" class="search-input" placeholder="Search movies...">
        <div class="search-results"></div>
    `;
    
    // Create user menu for mobile
    const mobileUserMenu = document.createElement('div');
    mobileUserMenu.className = 'user-menu mobile-user-menu';
    const userName = currentUser ? currentUser.name : 'User';
    const userInitial = currentUser ? currentUser.name.charAt(0).toUpperCase() : 'U';
    
    mobileUserMenu.innerHTML = `
        <div class="user-avatar">${userInitial}</div>
        <span>${userName}</span>
        <div class="user-dropdown">
            <a href="#" class="nav-link" data-page="profile">Profile</a>
            <a href="#" class="nav-link" data-page="my-list">My List</a>
            <a href="#" class="nav-link" data-page="downloads">Downloads</a>
            <a href="#" class="admin-logout-btn">Logout</a>
        </div>
    `;
    
    // Insert mobile elements at the beginning of nav
    nav.insertBefore(mobileSearch, nav.firstChild);
    nav.insertBefore(mobileUserMenu, nav.firstChild);
    
    // Re-initialize event listeners for mobile elements
    initMobileSearch(mobileSearch);
    initMobileUserMenu(mobileUserMenu);
}

// Initialize mobile search functionality
function initMobileSearch(searchContainer) {
    const searchInput = searchContainer.querySelector('.search-input');
    const searchResults = searchContainer.querySelector('.search-results');
    
    if (searchInput && searchResults) {
        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            
            if (query.length === 0) {
                searchResults.classList.remove('active');
                return;
            }
            
            const filteredMovies = movies.filter(movie => 
                movie.title.toLowerCase().includes(query) ||
                movie.genre.toLowerCase().includes(query) ||
                movie.description.toLowerCase().includes(query)
            );
            
            displaySearchResults(filteredMovies, searchResults);
        });
        
        // Close search results when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-container')) {
                searchResults.classList.remove('active');
            }
        });
    }
}

// Initialize mobile user menu
function initMobileUserMenu(userMenu) {
    const userDropdown = userMenu.querySelector('.user-dropdown');
    
    if (userMenu && userDropdown) {
        userMenu.addEventListener('click', function(e) {
            e.stopPropagation();
            userDropdown.classList.toggle('active');
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.mobile-user-menu')) {
                userDropdown.classList.remove('active');
            }
        });
    }
}

// Display search results
function displaySearchResults(results, searchResultsContainer) {
    if (!searchResultsContainer) return;
    
    searchResultsContainer.innerHTML = '';
    
    if (results.length === 0) {
        searchResultsContainer.innerHTML = '<div class="search-result-item">No results found</div>';
    } else {
        results.forEach(movie => {
            const resultItem = document.createElement('div');
            resultItem.className = 'search-result-item';
            resultItem.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <img src="${movie.poster}" alt="${movie.title}" style="width: 40px; height: 60px; object-fit: cover; border-radius: 6px;">
                    <div>
                        <strong>${movie.title}</strong>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">
                            ${movie.year} • ${movie.genre} • ⭐ ${movie.rating}
                        </div>
                    </div>
                </div>
            `;
            resultItem.addEventListener('click', function() {
                showMovieDetails(movie.id);
                searchResultsContainer.classList.remove('active');
                const searchInput = searchResultsContainer.parentElement.querySelector('.search-input');
                if (searchInput) searchInput.value = '';
            });
            searchResultsContainer.appendChild(resultItem);
        });
    }
    
    searchResultsContainer.classList.add('active');
}

// Initialize search functionality
function initSearch() {
    const searchInput = document.getElementById('search-input');
    const searchResults = document.getElementById('search-results');
    
    if (searchInput && searchResults) {
        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            
            if (query.length === 0) {
                searchResults.classList.remove('active');
                return;
            }
            
            const filteredMovies = movies.filter(movie => 
                movie.title.toLowerCase().includes(query) ||
                movie.genre.toLowerCase().includes(query) ||
                movie.description.toLowerCase().includes(query)
            );
            
            displaySearchResults(filteredMovies, searchResults);
        });
        
        // Close search results when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-container')) {
                searchResults.classList.remove('active');
            }
        });
    }
    
    // Also initialize mobile search if it exists
    const mobileSearch = document.querySelector('.mobile-search .search-input');
    if (mobileSearch) {
        mobileSearch.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            const mobileResults = this.parentElement.querySelector('.search-results');
            
            if (query.length === 0) {
                if (mobileResults) mobileResults.classList.remove('active');
                return;
            }
            
            const filteredMovies = movies.filter(movie => 
                movie.title.toLowerCase().includes(query) ||
                movie.genre.toLowerCase().includes(query) ||
                movie.description.toLowerCase().includes(query)
            );
            
            if (mobileResults) {
                displaySearchResults(filteredMovies, mobileResults);
            }
        });
    }
}

// Initialize video player
function initVideoPlayer() {
    // Watch Now button on movie details page
    const watchNowBtn = document.getElementById('watch-now-btn');
    if (watchNowBtn) {
        watchNowBtn.addEventListener('click', function() {
            const movieId = this.dataset.movieId;
            const movie = movies.find(m => m.id === parseInt(movieId));
            
            if (movie && movie.videoUrl) {
                playVideo(movie.videoUrl, movie.title);
            } else {
                showNotification('Video not available for this movie.', 'error');
            }
        });
    }
    
    // Add progress tracking
    if (videoPlayer) {
        // Track progress every 5 seconds
        videoPlayer.addEventListener('timeupdate', function() {
            if (videoPlayer.currentTime > 10) { // Only track after 10 seconds
                const movieId = getCurrentMovieId();
                if (movieId) {
                    const progress = {
                        currentTime: videoPlayer.currentTime,
                        duration: videoPlayer.duration,
                        percentage: (videoPlayer.currentTime / videoPlayer.duration) * 100,
                        timestamp: new Date().toISOString()
                    };
                    watchProgress[movieId] = progress;
                    localStorage.setItem('watchProgress', JSON.stringify(watchProgress));
                }
            }
        });

        // Resume from last position
        videoPlayer.addEventListener('loadedmetadata', function() {
            const movieId = getCurrentMovieId();
            if (movieId && watchProgress[movieId] && watchProgress[movieId].percentage < 95) {
                const progress = watchProgress[movieId];
                videoPlayer.currentTime = progress.currentTime;
                
                // Show resume prompt
                showResumePrompt(movieId, progress);
            }
        });
    }
    
    // Initialize Phase 1 features
    initSkipIntro();
    initQualitySelector();
    
    // Keyboard controls
    document.addEventListener('keydown', function(e) {
        if (videoPlayerOverlay && videoPlayerOverlay.classList.contains('active')) {
            switch(e.key) {
                case ' ':
                case 'Spacebar':
                    e.preventDefault();
                    if (videoPlayer.paused) {
                        videoPlayer.play();
                    } else {
                        videoPlayer.pause();
                    }
                    break;
                case 'Escape':
                    e.preventDefault();
                    closeVideoPlayer();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    videoPlayer.currentTime = Math.max(0, videoPlayer.currentTime - 10);
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    videoPlayer.currentTime = Math.min(videoPlayer.duration, videoPlayer.currentTime + 10);
                    break;
                case 'm':
                case 'M':
                    e.preventDefault();
                    videoPlayer.muted = !videoPlayer.muted;
                    break;
            }
        }
    });
}

// Enhanced video playback function with fallback
function playVideo(videoUrl, title) {
    if (!videoPlayer || !videoPlayerOverlay) {
        showNotification('Video player not available.', 'error');
        return;
    }
    
    console.log('Attempting to play video:', videoUrl);
    
    // Show loading state
    showNotification('Loading video...', 'success');
    
    // Reset video player
    videoPlayer.pause();
    videoPlayer.currentTime = 0;
    videoPlayer.volume = 1;
    
    // Set video source
    videoPlayer.src = videoUrl;
    videoPlayer.load();
    
    // Show video player
    videoPlayerOverlay.classList.add('active');
    
    // Add movie title to video player
    if (videoTitle) {
        videoTitle.textContent = title;
    }
    
    // Attempt to play
    const playPromise = videoPlayer.play();
    
    if (playPromise !== undefined) {
        playPromise.then(() => {
            console.log('Video playback started successfully');
            showNotification('Video playback started', 'success');
        }).catch(error => {
            console.error('Video play failed:', error);
            showNotification('Click the play button to start video', 'error');
            addManualPlayButton();
        });
    }
}

// Add manual play button for browsers that block autoplay
function addManualPlayButton() {
    const videoControls = document.querySelector('.video-controls');
    if (!videoControls) return;
    
    let manualPlayBtn = document.querySelector('.manual-play-btn');
    if (!manualPlayBtn) {
        manualPlayBtn = document.createElement('button');
        manualPlayBtn.className = 'btn-primary manual-play-btn';
        manualPlayBtn.textContent = 'Click to Play Video';
        manualPlayBtn.style.margin = '10px';
        manualPlayBtn.addEventListener('click', function() {
            videoPlayer.play().catch(error => {
                console.error('Manual play failed:', error);
                showNotification('Video cannot be played. Please try another movie.', 'error');
            });
            this.remove();
        });
        videoControls.appendChild(manualPlayBtn);
    }
}

// Initialize features section
function initFeaturesSection() {
    const featuresSection = document.querySelector('.features-section');
    if (featuresSection) {
        // Remove any hidden classes
        featuresSection.classList.remove('hidden');
        
        // Initialize intersection observer for feature animations
        const featureObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { 
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        });

        // Observe each feature
        document.querySelectorAll('.feature').forEach((feature, index) => {
            feature.style.transitionDelay = `${index * 0.2}s`;
            featureObserver.observe(feature);
        });
    }
}
// Complete the renderMovieGrid function
function renderMovieGrid(containerId, movies, showRemoveButton = false) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    container.innerHTML = '';
    
    if (movies.length === 0) {
        container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; padding: 40px;">No movies found.</p>';
        return;
    }
    
    movies.forEach(movie => {
        const movieCard = document.createElement('div');
        movieCard.className = 'movie-card';
        movieCard.setAttribute('data-movie-id', movie.id);
        
        // Check if movie is recently added (within 30 days)
        const isRecentlyAdded = movie.addedDate && 
            (new Date() - new Date(movie.addedDate)) < (30 * 24 * 60 * 60 * 1000);
        
        // Check if movie is downloaded
        const isDownloaded = offlineDownloads[movie.id];
        
        // Check if movie is in user's list
        const isInList = myList.includes(movie.id);
        
        movieCard.innerHTML = `
            <div class="movie-card-inner">
                ${isRecentlyAdded ? '<div class="new-badge">NEW</div>' : ''}
                ${isDownloaded ? '<div class="downloaded-badge"><i class="fas fa-check-circle"></i> Downloaded</div>' : ''}
                <img src="${movie.poster}" alt="${movie.title}" class="movie-poster">
                <div class="movie-info">
                    <h3 class="movie-title">${movie.title}</h3>
                    <div class="movie-meta">
                        <span>${movie.year}</span>
                        <span class="movie-rating"><i class="fas fa-star"></i> ${movie.rating}</span>
                    </div>
                    <div class="movie-actions">
                        <button class="btn-primary watch-now-btn" data-movie-id="${movie.id}">
                            <i class="fas fa-play"></i> Watch
                        </button>
                        ${!isDownloaded ? 
                            `<button class="btn-secondary download-movie-btn" data-movie-id="${movie.id}">
                                <i class="fas fa-download"></i> Download
                            </button>` :
                            `<button class="btn-secondary remove-download-btn" data-movie-id="${movie.id}">
                                <i class="fas fa-trash"></i> Remove
                            </button>`
                        }
                        ${!isInList ? 
                            `<button class="btn-secondary add-to-list-btn" data-movie-id="${movie.id}">
                                <i class="fas fa-plus"></i> My List
                            </button>` :
                            `<button class="btn-secondary remove-from-list-btn" data-movie-id="${movie.id}">
                                <i class="fas fa-check"></i> In List
                            </button>`
                        }
                        ${showRemoveButton ? 
                            `<button class="btn-secondary remove-from-list" data-movie-id="${movie.id}">Remove</button>` : 
                            ''
                        }
                    </div>
                </div>
            </div>
        `;
        
        // Add click event to show movie details (but not on buttons)
        movieCard.addEventListener('click', function(e) {
            if (!e.target.classList.contains('btn') && 
                !e.target.closest('.btn') &&
                !e.target.classList.contains('movie-actions') &&
                !e.target.closest('.movie-actions')) {
                showMovieDetails(movie.id);
            }
        });
        
        container.appendChild(movieCard);
    });
    
    // Add event listeners for buttons
    container.querySelectorAll('.watch-now-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            const movieId = parseInt(this.dataset.movieId);
            const movie = movies.find(m => m.id === movieId);
            if (movie && movie.videoUrl) {
                playVideo(movie.videoUrl, movie.title);
            }
        });
    });
    
    container.querySelectorAll('.download-movie-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            const movieId = parseInt(this.dataset.movieId);
            downloadMovie(movieId);
        });
    });
    
    container.querySelectorAll('.remove-download-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            const movieId = parseInt(this.dataset.movieId);
            removeDownload(movieId);
        });
    });
    
    container.querySelectorAll('.add-to-list-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            const movieId = parseInt(this.dataset.movieId);
            toggleMovieInList(movieId);
        });
    });
    
    container.querySelectorAll('.remove-from-list-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            const movieId = parseInt(this.dataset.movieId);
            toggleMovieInList(movieId);
        });
    });
    
    if (showRemoveButton) {
        container.querySelectorAll('.remove-from-list').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const movieId = parseInt(this.dataset.movieId);
                removeFromList(movieId);
            });
        });
    }
}

// Update download progress UI
function updateDownloadProgressUI(movieId, progress) {
    // Update progress bar if visible
    const progressBars = document.querySelectorAll(`[data-movie-id="${movieId}"] .download-progress`);
    progressBars.forEach(progressBar => {
        const fill = progressBar.querySelector('.download-progress-fill');
        if (fill) {
            fill.style.width = `${progress}%`;
        }
    });
    
    // Update downloads page if open
    if (document.getElementById('downloads-page') && 
        !document.getElementById('downloads-page').classList.contains('hidden')) {
        loadDownloadsPage();
    }
}

// Toggle movie in user's list
function toggleMovieInList(movieId) {
    const index = myList.indexOf(movieId);
    if (index === -1) {
        myList.push(movieId);
        showNotification('Added to My List', 'success');
    } else {
        myList.splice(index, 1);
        showNotification('Removed from My List', 'success');
    }
    localStorage.setItem('myList', JSON.stringify(myList));
    
    // Refresh the current view
    if (document.getElementById('my-list-page') && 
        !document.getElementById('my-list-page').classList.contains('hidden')) {
        loadMyListPage();
    }
    
    // Refresh other views
    refreshMovieGrids();
}

// Remove movie from list
function removeFromList(movieId) {
    const index = myList.indexOf(movieId);
    if (index !== -1) {
        myList.splice(index, 1);
        localStorage.setItem('myList', JSON.stringify(myList));
        showNotification('Removed from My List', 'success');
        loadMyListPage();
    }
}

// Show movie details
function showMovieDetails(movieId) {
    const movie = movies.find(m => m.id === movieId);
    if (!movie) return;
    
    // Hide all pages
    document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
    
    // Show movie details page
    const movieDetailsPage = document.getElementById('movie-details-page');
    if (movieDetailsPage) {
        movieDetailsPage.classList.remove('hidden');
        
        // Update movie details
        document.getElementById('detail-poster').src = movie.poster;
        document.getElementById('detail-poster').alt = movie.title;
        document.getElementById('detail-title').textContent = movie.title;
        document.getElementById('detail-year').textContent = movie.year;
        document.getElementById('detail-rating').textContent = movie.rating + '/10';
        document.getElementById('detail-duration').textContent = formatDuration(movie.duration);
        document.getElementById('detail-genre').textContent = movie.genre;
        document.getElementById('detail-description').textContent = movie.description;
        
        // Update background
        const bgDiv = movieDetailsPage.querySelector('.user-page-bg');
        if (bgDiv) {
            bgDiv.style.backgroundImage = `linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), url('${movie.poster}')`;
        }
        
        // Set data attributes for buttons
        const watchBtn = document.getElementById('watch-now-btn');
        const downloadBtn = document.getElementById('download-movie-btn');
        const addToListBtn = document.getElementById('add-to-list-btn');
        
        if (watchBtn) watchBtn.setAttribute('data-movie-id', movieId);
        if (downloadBtn) downloadBtn.setAttribute('data-movie-id', movieId);
        if (addToListBtn) addToListBtn.setAttribute('data-movie-id', movieId);
        
        // Update add to list button state
        if (addToListBtn) {
            if (myList.includes(movieId)) {
                addToListBtn.innerHTML = '<i class="fas fa-check"></i> In My List';
            } else {
                addToListBtn.innerHTML = '<i class="fas fa-plus"></i> Add to My List';
            }
        }
        
        // Update download button state
        if (downloadBtn) {
            if (offlineDownloads[movieId]) {
                downloadBtn.innerHTML = '<i class="fas fa-trash"></i> Remove Download';
                downloadBtn.onclick = function() {
                    removeDownload(movieId);
                };
            } else {
                downloadBtn.innerHTML = '<i class="fas fa-download"></i> Download';
                downloadBtn.onclick = function() {
                    downloadMovie(movieId);
                };
            }
        }
        
        // Load cast
        loadCastForMovie(movieId);
        
        // Load reviews
        loadReviewsForMovie(movieId);
        
        // Update active navigation
        document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
    }
}

// Format duration from minutes to hours and minutes
function formatDuration(minutes) {
    const hours = Math.floor(minutes / 60);
    const mins = minutes % 60;
    return hours > 0 ? `${hours}h ${mins}m` : `${mins}m`;
}

// Load cast for movie
function loadCastForMovie(movieId) {
    const castGrid = document.getElementById('cast-grid');
    if (!castGrid) return;
    
    // Mock cast data - in a real app, this would come from an API
    const mockCast = [
        { name: "Actor One", character: "Main Role", photo: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80" },
        { name: "Actor Two", character: "Supporting Role", photo: "https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80" },
        { name: "Actor Three", character: "Villain", photo: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80" },
        { name: "Actor Four", character: "Comic Relief", photo: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1964&q=80" }
    ];
    
    castGrid.innerHTML = '';
    mockCast.forEach(actor => {
        const castMember = document.createElement('div');
        castMember.className = 'cast-member';
        castMember.innerHTML = `
            <img src="${actor.photo}" alt="${actor.name}" class="cast-photo">
            <h4>${actor.name}</h4>
            <p>${actor.character}</p>
        `;
        castGrid.appendChild(castMember);
    });
}

// Load reviews for movie
function loadReviewsForMovie(movieId) {
    const reviewsList = document.getElementById('reviews-list');
    const ratingValue = document.querySelector('.rating-value');
    const stars = document.querySelectorAll('.stars i');
    const reviewCount = document.querySelector('.review-count');
    
    if (!reviewsList) return;
    
    // Get reviews for this movie
    const movieReviews = reviews[movieId] || [];
    
    // Update average rating
    if (movieReviews.length > 0) {
        const averageRating = movieReviews.reduce((sum, review) => sum + review.rating, 0) / movieReviews.length;
        if (ratingValue) ratingValue.textContent = averageRating.toFixed(1);
        
        // Update stars
        if (stars) {
            stars.forEach((star, index) => {
                if (index < Math.round(averageRating)) {
                    star.className = 'fas fa-star';
                } else {
                    star.className = 'far fa-star';
                }
            });
        }
        
        if (reviewCount) reviewCount.textContent = `${movieReviews.length} reviews`;
    } else {
        if (ratingValue) ratingValue.textContent = '0.0';
        if (stars) stars.forEach(star => star.className = 'far fa-star');
        if (reviewCount) reviewCount.textContent = '0 reviews';
    }
    
    // Display reviews
    reviewsList.innerHTML = '';
    
    if (movieReviews.length === 0) {
        reviewsList.innerHTML = '<div class="no-reviews">No reviews yet. Be the first to review this movie!</div>';
        return;
    }
    
    movieReviews.forEach(review => {
        const reviewItem = document.createElement('div');
        reviewItem.className = 'review-item';
        
        const reviewDate = new Date(review.date).toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });
        
        reviewItem.innerHTML = `
            <div class="review-header">
                <div class="reviewer-info">
                    <div class="reviewer-avatar">${review.userName.charAt(0).toUpperCase()}</div>
                    <div>
                        <h4>${review.userName}</h4>
                        <div class="review-rating">
                            ${'★'.repeat(review.rating)}${'☆'.repeat(5-review.rating)}
                        </div>
                    </div>
                </div>
                <div class="review-date">${reviewDate}</div>
            </div>
            <div class="review-text">${review.text}</div>
        `;
        
        reviewsList.appendChild(reviewItem);
    });
    
    // Add event listener for write review button
    const writeReviewBtn = document.querySelector('.write-review-btn');
    if (writeReviewBtn) {
        writeReviewBtn.addEventListener('click', function() {
            showReviewModal(movieId);
        });
    }
}

// Show review modal
function showReviewModal(movieId) {
    // Create modal if it doesn't exist
    let modal = document.getElementById('review-modal');
    if (!modal) {
        modal = document.createElement('div');
        modal.id = 'review-modal';
        modal.className = 'review-modal hidden';
        modal.innerHTML = `
            <div class="review-modal-content">
                <div class="modal-header">
                    <h2>Write a Review</h2>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="rating-selector">
                    <label>Your Rating</label>
                    <div class="star-rating" id="star-rating">
                        <i class="far fa-star" data-rating="1"></i>
                        <i class="far fa-star" data-rating="2"></i>
                        <i class="far fa-star" data-rating="3"></i>
                        <i class="far fa-star" data-rating="4"></i>
                        <i class="far fa-star" data-rating="5"></i>
                    </div>
                    <div class="rating-text" id="rating-text">Select a rating</div>
                </div>
                <div class="form-group">
                    <label for="review-text">Your Review</label>
                    <textarea id="review-text" rows="4" placeholder="Share your thoughts about this movie..."></textarea>
                </div>
                <div class="form-actions">
                    <button class="btn-primary" id="submit-review">Submit Review</button>
                    <button class="btn-secondary" id="cancel-review">Cancel</button>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
        
        // Add event listeners
        modal.querySelector('.close-modal').addEventListener('click', function() {
            modal.classList.add('hidden');
        });
        
        modal.querySelector('#cancel-review').addEventListener('click', function() {
            modal.classList.add('hidden');
        });
        
        // Star rating interaction
        const stars = modal.querySelectorAll('.star-rating i');
        stars.forEach(star => {
            star.addEventListener('mouseover', function() {
                const rating = parseInt(this.dataset.rating);
                highlightStars(rating);
            });
            
            star.addEventListener('click', function() {
                const rating = parseInt(this.dataset.rating);
                selectedRating = rating;
                updateRatingText(rating);
            });
        });
        
        modal.querySelector('.star-rating').addEventListener('mouseleave', function() {
            if (selectedRating) {
                highlightStars(selectedRating);
            } else {
                resetStars();
            }
        });
        
        // Submit review
        modal.querySelector('#submit-review').addEventListener('click', function() {
            submitReview(movieId);
        });
        
        // Close modal when clicking outside
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                modal.classList.add('hidden');
            }
        });
    }
    
    // Reset modal state
    selectedRating = 0;
    resetStars();
    modal.querySelector('#review-text').value = '';
    modal.querySelector('#rating-text').textContent = 'Select a rating';
    
    // Show modal
    modal.classList.remove('hidden');
}

let selectedRating = 0;

function highlightStars(rating) {
    const stars = document.querySelectorAll('#star-rating i');
    stars.forEach((star, index) => {
        if (index < rating) {
            star.className = 'fas fa-star';
        } else {
            star.className = 'far fa-star';
        }
    });
}

function resetStars() {
    const stars = document.querySelectorAll('#star-rating i');
    stars.forEach(star => {
        star.className = 'far fa-star';
    });
}

function updateRatingText(rating) {
    const texts = ['Poor', 'Fair', 'Good', 'Very Good', 'Excellent'];
    document.getElementById('rating-text').textContent = texts[rating - 1];
}

function submitReview(movieId) {
    const reviewText = document.getElementById('review-text').value.trim();
    
    if (!selectedRating) {
        showNotification('Please select a rating', 'error');
        return;
    }
    
    if (!reviewText) {
        showNotification('Please write a review', 'error');
        return;
    }
    
    // Initialize reviews for this movie if needed
    if (!reviews[movieId]) {
        reviews[movieId] = [];
    }
    
    // Add review
    reviews[movieId].push({
        userId: currentUser.email,
        userName: currentUser.name,
        rating: selectedRating,
        text: reviewText,
        date: new Date().toISOString()
    });
    
    // Save to localStorage
    localStorage.setItem('movieReviews', JSON.stringify(reviews));
    
    // Close modal
    document.getElementById('review-modal').classList.add('hidden');
    
    // Reload reviews
    loadReviewsForMovie(movieId);
    
    showNotification('Thank you for your review!', 'success');
}

// PHASE 1: Skip intro functionality
function initSkipIntro() {
    const skipIntroBtn = document.createElement('button');
    skipIntroBtn.className = 'skip-intro-btn hidden';
    skipIntroBtn.textContent = 'Skip Intro';
    skipIntroBtn.id = 'skip-intro-btn';
    
    document.body.appendChild(skipIntroBtn);
    
    if (videoPlayer) {
        videoPlayer.addEventListener('timeupdate', function() {
            if (videoPlayer.currentTime > 90 && videoPlayer.currentTime < 150) { // Between 1.5 and 2.5 minutes
                skipIntroBtn.classList.remove('hidden');
            } else {
                skipIntroBtn.classList.add('hidden');
            }
        });
    }
    
    skipIntroBtn.addEventListener('click', function() {
        if (videoPlayer) {
            videoPlayer.currentTime = 150; // Skip to 2.5 minutes
            this.classList.add('hidden');
        }
    });
}

// PHASE 1: Quality selector functionality
function initQualitySelector() {
    const qualitySelector = document.createElement('div');
    qualitySelector.className = 'quality-selector hidden';
    qualitySelector.id = 'quality-selector';
    
    qualitySelector.innerHTML = `
        <div class="quality-options">
            <h4>Select Quality</h4>
            <div class="quality-option" data-quality="1080p">
                <div>
                    <span>1080p</span>
                    <div class="quality-bitrate">High quality (4 Mbps)</div>
                </div>
                <i class="fas fa-check"></i>
            </div>
            <div class="quality-option" data-quality="720p">
                <div>
                    <span>720p</span>
                    <div class="quality-bitrate">Medium quality (2.5 Mbps)</div>
                </div>
                <i class="fas fa-check"></i>
            </div>
            <div class="quality-option" data-quality="480p">
                <div>
                    <span>480p</span>
                    <div class="quality-bitrate">Low quality (1.5 Mbps)</div>
                </div>
                <i class="fas fa-check"></i>
            </div>
        </div>
    `;
    
    document.body.appendChild(qualitySelector);
    
    // Quality selection
    qualitySelector.querySelectorAll('.quality-option').forEach(option => {
        option.addEventListener('click', function() {
            const quality = this.dataset.quality;
            
            // Update active state
            qualitySelector.querySelectorAll('.quality-option').forEach(opt => {
                opt.classList.remove('active');
                opt.querySelector('.fa-check').style.display = 'none';
            });
            this.classList.add('active');
            this.querySelector('.fa-check').style.display = 'block';
            
            // Change video quality
            changeVideoQuality(quality);
        });
    });
    
    // Show/hide quality selector
    const videoControls = document.querySelector('.video-controls');
    if (videoControls) {
        const qualityBtn = document.createElement('button');
        qualityBtn.className = 'quality-btn';
        qualityBtn.innerHTML = '<i class="fas fa-cog"></i> Quality';
        qualityBtn.addEventListener('click', function() {
            qualitySelector.classList.toggle('hidden');
        });
        videoControls.appendChild(qualityBtn);
        
        // Close quality selector when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.quality-selector') && !e.target.closest('.quality-btn')) {
                qualitySelector.classList.add('hidden');
            }
        });
    }
}

function changeVideoQuality(quality) {
    if (!videoPlayer) return;
    
    const currentTime = videoPlayer.currentTime;
    const isPlaying = !videoPlayer.paused;
    
    // Get the new video URL based on quality
    const qualityMap = {
        '1080p': videoQualities[1].url,
        '720p': videoQualities[2].url,
        '480p': videoQualities[3].url
    };
    
    const newUrl = qualityMap[quality];
    if (!newUrl) return;
    
    showNotification(`Switching to ${quality}...`, 'success');
    
    // Change source and resume playback
    videoPlayer.src = newUrl;
    videoPlayer.load();
    
    videoPlayer.onloadeddata = function() {
        videoPlayer.currentTime = currentTime;
        if (isPlaying) {
            videoPlayer.play();
        }
        showNotification(`Quality changed to ${quality}`, 'success');
    };
}

// Load movies from localStorage
function loadMoviesFromStorage() {
    const storedMovies = localStorage.getItem('amviewMovies');
    if (storedMovies) {
        movies = JSON.parse(storedMovies);
    }
}

// Update movie new status based on time
function updateMovieNewStatus() {
    const thirtyDaysAgo = new Date();
    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
    
    movies.forEach(movie => {
        if (movie.addedDate) {
            const addedDate = new Date(movie.addedDate);
            movie.new = addedDate > thirtyDaysAgo;
        }
    });
    
    localStorage.setItem('amviewMovies', JSON.stringify(movies));
}

// Get current movie ID from video player
function getCurrentMovieId() {
    const currentVideoUrl = videoPlayer.src;
    const movie = movies.find(m => m.videoUrl === currentVideoUrl);
    return movie ? movie.id : null;
}

// Show resume prompt
function showResumePrompt(movieId, progress) {
    const movie = movies.find(m => m.id === movieId);
    if (!movie) return;
    
    // Create resume modal
    const resumeModal = document.createElement('div');
    resumeModal.className = 'resume-modal';
    resumeModal.innerHTML = `
        <div class="resume-content">
            <h3>Continue watching?</h3>
            <p>You were ${Math.round(progress.percentage)}% through "${movie.title}"</p>
            <div class="progress-bar">
                <div class="progress-fill" style="width: ${progress.percentage}%"></div>
            </div>
            <div class="resume-actions">
                <button class="btn-primary" id="resume-watching">Resume</button>
                <button class="btn-secondary" id="restart-watching">Restart</button>
            </div>
        </div>
    `;
    
    document.body.appendChild(resumeModal);
    
    // Add event listeners
    resumeModal.querySelector('#resume-watching').addEventListener('click', function() {
        videoPlayer.currentTime = progress.currentTime;
        resumeModal.remove();
        videoPlayer.play();
    });
    
    resumeModal.querySelector('#restart-watching').addEventListener('click', function() {
        videoPlayer.currentTime = 0;
        resumeModal.remove();
        videoPlayer.play();
    });
    
    // Auto-remove after 10 seconds
    setTimeout(() => {
        if (resumeModal.parentNode) {
            resumeModal.remove();
        }
    }, 10000);
}

// Update UI with Phase 2 features
function updateUIWithPhase2Features() {
    // Add downloads link to navigation
    const navLinks = document.querySelector('nav ul');
    if (navLinks) {
        const downloadsLink = navLinks.querySelector('[data-page="downloads"]');
        if (!downloadsLink) {
            const li = document.createElement('li');
            li.innerHTML = '<a href="#" class="nav-link" data-page="downloads">Downloads</a>';
            navLinks.appendChild(li);
        }
    }
    
    // Add refresh recommendations button event listener
    const refreshBtn = document.getElementById('refresh-recommendations');
    if (refreshBtn) {
        refreshBtn.addEventListener('click', function(e) {
            e.preventDefault();
            generateRecommendations();
            showNotification('Recommendations refreshed!', 'success');
        });
    }
}

// Initialize the enhanced movie grid function
enhanceMovieCardsWithDownloads();

console.log('AMVIEW application initialization complete!');
</script>
</body>
</html>